/* ========================================
 *
 * Copyright MIT, 2014
 * All Rights Reserved
 * UNPUBLISHED, LICENSED SOFTWARE.
 *
 * CONFIDENTIAL AND PROPRIETARY INFORMATION
 * WHICH IS THE PROPERTY OF MIT.
 *
 * ========================================
*/

#include <project.h>
#include "stdlib.h"
#include "string.h"
#include "stdio.h"
#include "cydevice_trm.h"
#include <math.h>

#define MAXITER 150
#define STAYITER 500

//Global Variables
uint32 global_time_loops = 0;
uint32 global_time = 0;
int i = 1;

uint32 loop_iter = 0;
uint32 inter_iter = 2;
uint32 inter_iter2 = 0;

int motor1pos_current;
int motor1pos_previous;

int motor2pos_current;
int motor2pos_previous;

int motor3pos_current;
int motor3pos_previous;

int motor4pos_current;
int motor4pos_previous;

int motor5pos_current;
int motor5pos_previous;

int motor6pos_current;
int motor6pos_previous;

int motor7pos_current;
int motor7pos_previous;

int motor8pos_current;
int motor8pos_previous;

int velMeasured1;
int velMeasured2;
int velMeasured3;
int velMeasured4;
int velMeasured5;
int velMeasured6;
int velMeasured7;
int velMeasured8;

char IMUstr[95];
char yaw_c[9];
char pitch_c[9];
char roll_c[9];
char accelX_c[8];
char accelY_c[8];
char accelZ_c[8];
char yawdot_c[11];
char pitchdot_c[11];
char rolldot_c[11];

double yaw;
double pitch;
double roll;
double accelX;
double accelY;
double accelZ;
double yawdot;
double pitchdot;
double rolldot;

int cmdVal1;
int cmdVal2;
int cmdVal3;
int cmdVal4;
int cmdVal5;
int cmdVal6;
int cmdVal7;
int cmdVal8;

float angle1; //physical angle of link coming from motor1. Directly downwards is zero. Program must be initialized pointing directly downwards.
float angle2; //physical angle of link coming from motor2. Directly downwards is zero. Program must be initialized pointing directly downwards.
float angle3;
float angle4;
float angle5;
float angle6;
float angle7;
float angle8;

int angleIndex1; //index for angle of motor1, used to find appropriate values in Jacobian arrays
int angleIndex2; //index for angle of motor2, used to find appropriate values in Jacobian arrays
int angleIndex3;
int angleIndex4;
int angleIndex5;
int angleIndex6;
int angleIndex7;
int angleIndex8;

 float torque1; //torque to be applied by motor1
 float torque2; //torque to be applied by motor2
 float torque3;
 float torque4;
 float torque5;
 float torque6;
 float torque7;
 float torque8;

int Estop = 0;

char IMUstr[95];

//Prints any 16 bit integer to UART
void Print16(int16 Angle)
{
    char mystr[10];
    sprintf(mystr,"%d",Angle);
    UART_1_PutString(mystr);
    UART_1_PutChar(10);
}

//Prints any 32 bit integer to UART
void Print32(int32 Angle)
{
    char mystr[10];
    sprintf(mystr,"%d",Angle);
    UART_1_PutString(mystr);
    UART_1_PutChar(10);
}

void GetIMUdata()
{
if (UART_2_GetRxBufferSize() == 95){
int i;
for (i=0; i<95; i++) {
IMUstr[i] = UART_2_ReadRxData();
}

for (i=0; i<8;i++) {
yaw_c[i] = IMUstr[i+7];
pitch_c[i] = IMUstr[i+16];
roll_c[i] = IMUstr[i+25];

yaw=strtod(yaw_c,NULL);
pitch=strtod(pitch_c,NULL);
roll=strtod(roll_c,NULL);
}

for (i=0; i<7;i++) {
accelX_c[i] = IMUstr[i+34];
accelY_c[i] = IMUstr[i+42];
accelZ_c[i] = IMUstr[i+50];

accelX=strtod(accelX_c,NULL);
accelY=strtod(accelY_c,NULL);
accelZ=strtod(accelZ_c,NULL);
}

for (i=0; i<10;i++) {
yawdot_c[i] = IMUstr[i+58];
pitchdot_c[i] = IMUstr[i+69];
rolldot_c[i] = IMUstr[i+80];

yawdot=strtod(yawdot_c,NULL);
pitchdot=strtod(pitchdot_c,NULL);
rolldot=strtod(rolldot_c,NULL);
}


UART_2_ClearRxBuffer();
}
}

int round_integer(float num) {
    if (num>0) {
        return (int)((num+0.5));}
    else {
        return (int)((num-0.5));}
}



void Index_ISR_1()
{
velMeasured1 = ((motor1pos_current - motor1pos_previous)*1000000)/(Timer_2_ReadPeriod());
velMeasured2 = ((motor2pos_current - motor2pos_previous)*1000000)/(Timer_2_ReadPeriod());
velMeasured3 = ((motor3pos_current - motor3pos_previous)*1000000)/(Timer_2_ReadPeriod());
velMeasured4 = ((motor4pos_current - motor4pos_previous)*1000000)/(Timer_2_ReadPeriod());
velMeasured5 = ((motor5pos_current - motor5pos_previous)*1000000)/(Timer_2_ReadPeriod());
velMeasured6 = ((motor6pos_current - motor6pos_previous)*1000000)/(Timer_2_ReadPeriod());
velMeasured7 = ((motor7pos_current - motor7pos_previous)*1000000)/(Timer_2_ReadPeriod());
velMeasured8 = ((motor8pos_current - motor8pos_previous)*1000000)/(Timer_2_ReadPeriod());

motor1pos_previous = motor1pos_current;
motor2pos_previous = motor2pos_current;
motor3pos_previous = motor3pos_current;
motor4pos_previous = motor4pos_current;
motor5pos_previous = motor5pos_current;
motor6pos_previous = motor6pos_current;
motor7pos_previous = motor7pos_current;
motor8pos_previous = motor8pos_current;
}

//Put any UART data here
void Index_ISR_3()
{
    UART_1_LoadTxConfig();
    Print32(inter_iter);
    Print32(loop_iter);
    inter_iter2++;
    if (inter_iter2 >= STAYITER){
        Timer_3_WritePeriod(inter_iter*100);
        inter_iter++;
        inter_iter2=0;
        if (inter_iter > MAXITER)
            inter_iter = 2;
    }
}

int main()
{
    CyGlobalIntEnable;

    UART_1_Start();
    UART_2_Start();
    UART_2_ClearRxBuffer();
    PWM_1_Start();
    PWM_2_Start();
    PWM_3_Start();
    PWM_4_Start();
    PWM_5_Start();
    Timer_2_Start();
    Timer_3_Start();

    Counter_1_Start();
    Counter_2_Start();
    Counter_3_Start();
    Counter_4_Start();
    Counter_5_Start();
    Counter_6_Start();
    Counter_7_Start();
    Counter_8_Start();

    isr_1_StartEx(Index_ISR_1); //interrupt routine measures velocity
    isr_3_StartEx(Index_ISR_3); //interrupt routine prints to bluetooth UART
    
    int16 J1_1[61][60] = {{-12843,-8645,-5434,-2944,-987,574,1834,2864,3713,4421,5014,5514,5937,6298,6604,6865,7087,7274,7432,7563,7671,7758,7826,7876,7911,7931,7938,7933,7916,7889,7851,7804,7749,7685,7613,7534,7449,7357,7258,7155,7046,6932,6813,6690,6563,6432,6298,6161,6020,5877,5732,5585,5436,5285,5133,4979,4825,4670,4514,4359},
{-12605,-8841,-5868,-3501,-1599,-54,1213,2261,3135,3870,4491,5019,5469,5854,6184,6467,6708,6915,7090,7237,7360,7460,7541,7603,7649,7679,7696,7699,7691,7671,7641,7601,7552,7495,7429,7356,7276,7189,7096,6997,6892,6783,6669,6550,6427,6300,6170,6037,5900,5761,5620,5476,5330,5183,5034,4884,4734,4582,4430,4278},
{-12056,-8703,-5985,-3772,-1958,-462,781,1823,2700,3444,4078,4621,5087,5487,5833,6130,6387,6606,6794,6953,7087,7198,7289,7361,7415,7454,7478,7489,7488,7474,7451,7417,7373,7321,7261,7193,7117,7035,6946,6852,6751,6646,6535,6421,6301,6178,6052,5922,5789,5653,5515,5375,5232,5088,4943,4796,4649,4501,4352,4203},
{-11358,-8372,-5898,-3846,-2138,-708,496,1514,2381,3121,3757,4305,4778,5187,5541,5848,6114,6343,6540,6708,6850,6969,7067,7146,7208,7253,7284,7300,7305,7297,7278,7249,7211,7163,7107,7043,6972,6894,6809,6718,6621,6519,6413,6301,6185,6066,5942,5815,5686,5553,5418,5281,5142,5001,4858,4715,4570,4425,4279,4133},
{-10602,-7934,-5684,-3789,-2188,-832,322,1308,2154,2882,3511,4057,4531,4943,5301,5613,5884,6119,6321,6496,6644,6769,6872,6957,7024,7074,7110,7131,7140,7137,7122,7098,7063,7019,6967,6907,6839,6764,6683,6595,6502,6403,6299,6191,6078,5961,5841,5717,5590,5460,5328,5194,5057,4919,4780,4639,4497,4355,4212,4069},
{-9836,-7441,-5393,-3643,-2148,-868,232,1180,1999,2710,3327,3866,4335,4746,5105,5418,5691,5929,6135,6313,6465,6594,6702,6790,6861,6915,6954,6980,6992,6993,6982,6960,6929,6888,6839,6782,6717,6645,6567,6482,6392,6296,6195,6089,5979,5865,5747,5625,5501,5374,5245,5113,4979,4844,4707,4569,4429,4290,4149,4009},
{-9088,-6926,-5056,-3440,-2045,-839,206,1113,1902,2591,3194,3721,4183,4589,4945,5257,5531,5769,5977,6156,6311,6442,6552,6643,6717,6774,6816,6844,6860,6863,6854,6836,6807,6769,6723,6668,6606,6537,6461,6378,6290,6197,6098,5995,5887,5775,5660,5541,5419,5294,5167,5038,4906,4773,4639,4503,4367,4229,4091,3953},
{-8371,-6409,-4695,-3200,-1898,-763,227,1093,1851,2516,3101,3615,4068,4466,4818,5127,5398,5635,5843,6023,6178,6310,6422,6515,6590,6649,6693,6723,6741,6746,6740,6723,6697,6661,6617,6564,6504,6437,6363,6283,6197,6105,6009,5908,5802,5693,5579,5463,5343,5220,5095,4968,4839,4708,4576,4443,4308,4173,4038,3902},
{-7691,-5901,-4324,-2938,-1721,-653,285,1110,1836,2476,3042,3541,3982,4372,4717,5021,5289,5524,5730,5909,6064,6196,6309,6402,6478,6538,6584,6615,6634,6641,6636,6622,6597,6563,6520,6470,6411,6346,6274,6195,6111,6022,5927,5828,5724,5616,5505,5390,5272,5152,5029,4904,4777,4648,4518,4386,4254,4121,3988,3855},
{-7049,-5408,-3952,-2663,-1525,-519,369,1154,1849,2464,3010,3493,3922,4303,4639,4938,5201,5433,5636,5813,5967,6098,6210,6304,6380,6441,6487,6519,6539,6547,6543,6530,6506,6474,6432,6383,6326,6262,6192,6115,6032,5944,5851,5754,5652,5546,5436,5323,5207,5088,4967,4844,4719,4592,4464,4334,4204,4073,3942,3811},
{-6445,-4934,-3584,-2383,-1316,-368,473,1220,1884,2475,3000,3467,3883,4253,4581,4873,5131,5358,5558,5732,5884,6014,6125,6218,6294,6355,6401,6434,6454,6463,6460,6447,6424,6393,6353,6304,6249,6186,6117,6041,5960,5873,5782,5685,5585,5480,5372,5261,5147,5030,4910,4788,4665,4540,4414,4414,4158,4029,3900,3770},
{-5878,-4480,-3225,-2102,-1100,-206,591,1302,1937,2503,3008,3460,3862,4221,4540,4824,5076,5298,5494,5666,5815,5943,6052,6144,6219,6280,6326,6358,6378,6387,6385,6372,6350,6320,6280,6233,6178,6116,6048,5973,5893,5808,5718,5623,5523,5420,5314,5204,5091,4975,4857,4737,4615,4492,4367,4241,4115,3988,3860,3732},
{-5345,-4046,-2876,-1824,-881,-37,720,1397,2003,2546,3032,3466,3855,4203,4513,4789,5034,5252,5443,5611,5757,5883,5990,6080,6154,6214,6259,6291,6311,6320,6318,6305,6284,6253,6214,6168,6113,6052,5985,5911,5832,5748,5658,5565,5467,5365,5259,5151,5039,4925,4808,4690,4569,4447,4324,4200,4075,3950,3824,3698},
{-4844,-3633,-2538,-1551,-662,138,856,1501,2080,2600,3067,3486,3861,4197,4498,4766,5005,5216,5403,5567,5709,5832,5937,6026,6098,6156,6201,6232,6252,6260,6257,6245,6224,6193,6155,6108,6055,5994,5927,5855,5776,5693,5604,5511,5414,5313,5209,5102,4991,4878,4763,4646,4527,4406,4285,4162,4038,3915,3790,3666},
{-4372,-3240,-2212,-1283,-443,314,996,1611,2165,2663,3112,3515,3877,4202,4493,4753,4985,5190,5372,5532,5671,5791,5893,5979,6050,6107,6150,6180,6199,6207,6204,6191,6170,6139,6101,6055,6001,5941,5875,5803,5725,5642,5554,5462,5366,5266,5163,5056,4947,4835,4721,4605,4487,4368,4248,4127,4005,3882,3760,3637},
{-3927,-2865,-1898,-1022,-227,491,1140,1727,2256,2734,3165,3553,3902,4216,4497,4749,4974,5173,5350,5505,5640,5757,5857,5940,6009,6064,6105,6135,6152,6159,6156,6143,6121,6091,6052,6006,5953,5893,5827,5755,5678,5596,5509,5417,5322,5223,5120,5015,4906,4795,4683,4568,4451,4333,4214,4094,3973,3852,3731,3610},
{-3507,-2508,-1597,-768,-15,668,1286,1846,2352,2810,3224,3598,3934,4237,4509,4753,4970,5164,5335,5485,5617,5730,5827,5908,5974,6027,6067,6095,6112,6118,6114,6100,6078,6047,6008,5962,5909,5849,5784,5712,5635,5553,5467,5376,5281,5183,5081,4976,4869,4759,4647,4533,4418,4301,4183,4064,3945,3825,3705,3585},
{-3109,-2167,-1306,-521,193,843,1432,1967,2452,2891,3289,3648,3972,4265,4527,4763,4974,5161,5327,5472,5600,5709,5803,5881,5946,5996,6035,6061,6076,6081,6076,6062,6039,6008,5969,5922,5869,5810,5744,5673,5596,5514,5428,5338,5244,5146,5045,4941,4834,4725,4614,4501,4387,4271,4154,4036,3918,3800,3681,3562},
{-2732,-1842,-1027,-282,397,1016,1578,2090,2554,2975,3357,3703,4016,4298,4551,4779,4982,5164,5324,5465,5588,5694,5785,5860,5922,5971,6007,6032,6046,6050,6044,6028,6005,5973,5933,5887,5833,5774,5708,5637,5560,5479,5393,5303,5209,5112,5012,4908,4802,4694,4584,4472,4358,4243,4128,4011,3894,3777,3659,3542},
{-2374,-1531,-758,-50,596,1186,1723,2213,2658,3062,3429,3762,4063,4335,4580,4800,4996,5171,5326,5463,5582,5684,5771,5844,5903,5949,5984,6007,6020,6022,6015,5999,5974,5942,5902,5855,5801,5741,5675,5604,5528,5447,5361,5271,5178,5081,4981,4878,4773,4666,4556,4445,4332,4218,4103,3988,3872,3755,3639,3523},
{-2033,-1233,-499,175,791,1354,1867,2336,2763,3151,3504,3824,4114,4376,4612,4825,5014,5184,5333,5465,5579,5678,5762,5832,5888,5933,5965,5986,5997,5998,5990,5973,5947,5914,5874,5826,5772,5712,5646,5575,5498,5417,5332,5242,5149,5053,4953,4851,4746,4639,4531,4420,4308,4195,4081,3966,3851,3736,3621,3505},
{-1708,-948,-249,392,980,1518,2010,2459,2868,3241,3580,3889,4168,4421,4648,4853,5036,5200,5344,5471,5581,5676,5757,5824,5878,5919,5950,5969,5979,5978,5969,5950,5924,5890,5849,5801,5746,5686,5619,5548,5471,5390,5305,5216,5123,5027,4928,4826,4722,4616,4507,4397,4286,4174,4061,3947,3833,3718,3604,3490},
{-1398,-675,-9,603,1165,1679,2150,2581,2974,3332,3659,3955,4224,4468,4687,4885,5062,5219,5358,5481,5587,5678,5755,5819,5870,5910,5938,5956,5963,5961,5950,5931,5904,5869,5827,5778,5723,5662,5596,5524,5447,5366,5281,5192,5099,5003,4905,4803,4699,4594,4486,4377,4266,4155,4042,3929,3816,3702,3589,3476},
{-1102,-412,223,808,1345,1837,2289,2702,3079,3424,3738,4023,4282,4517,4729,4919,5090,5241,5376,5493,5595,5683,5757,5818,5866,5903,5929,5945,5951,5947,5935,5914,5886,5850,5807,5758,5703,5641,5574,5502,5426,5344,5259,5170,5078,4982,4883,4782,4679,4574,4466,4358,4248,4137,4025,3913,3800,3688,3575,3463},
{-818,-160,447,1006,1520,1992,2425,2821,3184,3515,3818,4093,4342,4568,4772,4956,5120,5266,5395,5509,5607,5691,5761,5819,5865,5899,5923,5937,5941,5936,5922,5901,5871,5834,5791,5741,5684,5623,5555,5483,5406,5325,5239,5150,5058,4963,4864,4763,4660,4555,4449,4341,4231,4121,4010,3898,3786,3674,3563,3451},
{-546,83,664,1199,1691,2144,2559,2940,3288,3607,3898,4163,4403,4621,4818,4995,5153,5294,5418,5526,5621,5701,5768,5823,5866,5898,5920,5932,5934,5927,5912,5889,5859,5821,5776,5725,5669,5606,5538,5466,5389,5307,5222,5133,5040,4945,4847,4746,4644,4539,4433,4325,4216,4106,3996,3885,3774,3663,3551,3441},
{-285,317,873,1385,1857,2292,2691,3057,3392,3698,3978,4233,4465,4675,4865,5035,5187,5323,5442,5546,5637,5713,5777,5829,5870,5899,5919,5929,5929,5921,5904,5880,5848,5809,5764,5712,5655,5592,5524,5451,5373,5291,5206,5117,5024,4929,4831,4731,4628,4524,4418,4311,4202,4093,4093,3873,3762,3652,3541,3432},
{-33,543,1075,1566,2020,2436,2820,3172,3494,3789,4059,4305,4528,4730,4913,5077,5223,5354,5468,5568,5655,5728,5788,5837,5875,5903,5920,5928,5926,5916,5898,5873,5840,5800,5754,5701,5643,5579,5511,5437,5359,5277,5192,5102,5010,4915,4817,4717,4614,4510,4405,4298,4190,4081,3972,3862,3752,3642,3532,3423},
{208,760,1271,1743,2177,2578,2947,3285,3595,3880,4139,4376,4591,4786,4962,5120,5261,5386,5496,5592,5674,5744,5801,5848,5883,5908,5923,5928,5925,5914,5894,5867,5833,5792,5745,5692,5633,5569,5499,5425,5347,5265,5179,5090,4997,4902,4804,4704,4602,4498,4393,4286,4179,4070,3961,3852,3743,3634,3524,3416},
{441,971,1461,1913,2331,2716,3071,3397,3695,3969,4219,4447,4654,4842,5011,5163,5299,5419,5525,5617,5695,5762,5816,5859,5892,5914,5927,5931,5926,5913,5892,5864,5828,5786,5738,5684,5624,5559,5490,5415,5337,5254,5168,5078,4986,4890,4793,4693,4591,4487,4382,4276,4169,4061,3952,3843,3735,3626,3517,3409},
{666,1174,1645,2080,2481,2852,3193,3506,3794,4058,4299,4518,4718,4899,5062,5208,5338,5454,5555,5643,5718,5781,5832,5873,5903,5923,5933,5935,5929,5914,5891,5862,5825,5782,5733,5678,5617,5552,5481,5406,5327,5245,5158,5068,4976,4880,4783,4683,4581,4477,4373,4267,4160,4052,3944,3836,3727,3619,3511,3404},
{882,1371,1823,2241,2628,2984,3312,3614,3891,4145,4378,4589,4782,4956,5113,5253,5379,5489,5586,5670,5742,5801,5849,5887,5915,5932,5941,5941,5932,5916,5892,5861,5823,5779,5729,5673,5612,5545,5474,5399,5319,5236,5150,5060,4967,4871,4774,4674,4572,4469,4364,4258,4152,4044,3937,3829,3721,3613,3506,3399},
{1092,1561,1996,2398,2770,3113,3429,3720,3987,4232,4456,4660,4845,5013,5164,5299,5419,5526,5618,5698,5766,5823,5868,5903,5928,5943,5950,5948,5937,5919,5894,5862,5823,5777,5726,5669,5607,5540,5469,5393,5313,5229,5142,5052,4959,4864,4766,4666,4564,4461,4356,4251,4145,4038,3930,3823,3715,3608,3501,3394},
{1294,1745,2164,2551,2909,3239,3544,3824,4082,4318,4533,4730,4908,5070,5215,5345,5460,5562,5651,5727,5792,5845,5887,5920,5942,5955,5960,5956,5944,5924,5897,5863,5823,5777,5725,5667,5604,5536,5464,5388,5307,5223,5136,5045,4952,4857,4759,4659,4557,4454,4350,4244,4138,4031,3925,3817,3710,3603,3497,3391},
{1490,1924,2327,2700,3044,3363,3656,3926,4174,4402,4610,4799,4971,5126,5266,5391,5502,5599,5684,5757,5818,5868,5908,5937,5957,5968,5971,5965,5951,5930,5901,5866,5825,5777,5724,5665,5602,5533,5460,5383,5303,5218,5131,5040,4947,4851,4753,4653,4551,4448,4344,4239,4133,4026,3920,3813,3706,3599,3493,3388},
{1679,2098,2485,2844,3176,3483,3766,4027,4266,4485,4685,4868,5033,5183,5317,5437,5544,5637,5718,5787,5845,5892,5928,5955,5973,5982,5982,5974,5959,5936,5906,5870,5827,5779,5725,5665,5601,5531,5458,5380,5299,5214,5126,5035,4942,4846,4748,4648,4546,4443,4339,4234,4128,4022,3915,3809,3702,3596,3490,3385},
{1863,2266,2639,2985,3305,3601,3874,4125,4355,4567,4760,4936,5095,5239,5368,5484,5585,5675,5752,5817,5872,5916,5950,5974,5990,5996,5995,5985,5968,5944,5912,5875,5831,5781,5726,5665,5600,5530,5456,5378,5296,5211,5123,5031,4937,4841,4743,4643,4541,4438,4334,4229,4124,4018,3911,3805,3699,3593,3487,3383},
{2041,2429,2789,3122,3431,3716,3979,4221,4444,4647,4833,5003,5156,5295,5419,5530,5627,5712,5786,5848,5899,5941,5972,5994,6007,6012,6008,5996,5978,5952,5919,5880,5835,5784,5728,5667,5601,5530,5455,5376,5294,5208,5120,5028,4934,4838,4739,4639,4538,4435,4331,4226,4120,4014,3908,3802,3696,3590,3485,3381},
{2213,2587,2934,3256,3553,3828,4082,4315,4530,4726,4906,5069,5217,5350,5469,5575,5669,5750,5820,5879,5927,5966,5994,6014,6025,6027,6022,6008,5988,5960,5926,5886,5840,5788,5731,5668,5602,5530,5455,5376,5293,5207,5117,5026,4931,4835,4736,4636,4534,4431,4327,4223,4117,4011,3906,3800,3694,3588,3484,3379},
{2380,2741,3075,3385,3672,3938,4183,4408,4615,4804,4977,5134,5277,5405,5519,5621,5710,5788,5854,5910,5955,5991,6017,6034,6043,6043,6036,6021,5998,5970,5934,5893,5845,5792,5734,5671,5603,5531,5455,5375,5292,5205,5116,5024,4929,4832,4734,4633,4532,4429,4325,4220,4115,4009,3903,3797,3692,3587,3482,3378},
{2542,2890,3213,3512,3789,4045,4281,4498,4698,4880,5047,5199,5335,5459,5569,5666,5751,5825,5888,5941,5983,6016,6040,6055,6061,6059,6050,6033,6010,5979,5942,5900,5851,5797,5738,5674,5605,5533,5456,5375,5292,5205,5115,5022,4927,4830,4732,4631,4529,4426,4322,4218,4112,4007,3901,3796,3690,3585,3481,3377},
{2699,3035,3346,3635,3902,4149,4377,4587,4779,4955,5116,5262,5394,5512,5617,5711,5792,5863,5922,5972,6011,6042,6063,6075,6080,6076,6065,6046,6021,5989,5951,5907,5857,5802,5742,5677,5608,5535,5457,5376,5292,5204,5114,5021,4926,4829,4730,4629,4527,4424,4320,4216,4111,4005,3900,3794,3689,3584,3480,3376},
{2852,3175,3476,3754,4012,4251,4471,4673,4859,5029,5183,5324,5451,5564,5665,5755,5833,5900,5956,6003,6039,6067,6086,6096,6098,6093,6080,6060,6033,6000,5960,5915,5864,5808,5747,5681,5611,5537,5459,5377,5293,5205,5114,5021,4925,4828,4729,4628,4526,4423,4319,4214,4109,4004,3898,3793,3688,3583,3479,3376},
{2999,3312,3602,3871,4120,4350,4562,4758,4937,5100,5250,5385,5507,5616,5713,5798,5873,5936,5990,6033,6067,6092,6109,6117,6117,6110,6095,6073,6045,6010,5969,5923,5871,5814,5752,5685,5615,5540,5461,5379,5293,5205,5114,5021,4925,4827,4728,4627,4525,4422,4318,4213,4108,4003,3897,3792,3687,3583,3479,3376},
{3143,3444,3724,3984,4225,4447,4652,4840,5013,5171,5314,5444,5562,5667,5759,5841,5912,5972,6023,6063,6095,6117,6132,6138,6136,6126,6110,6087,6057,6021,5979,5931,5878,5820,5757,5690,5618,5543,5463,5381,5295,5206,5115,5021,4925,4827,4727,4626,4524,4421,4317,4212,4107,4002,3897,3791,3687,3582,3478,3375},
{3282,3573,3843,4094,4326,4541,4739,4920,5087,5239,5378,5503,5616,5716,5805,5883,5951,6008,6055,6093,6122,6142,6154,6158,6154,6143,6125,6100,6069,6032,5988,5939,5885,5826,5763,5694,5622,5546,5466,5383,5296,5207,5115,5021,4925,4827,4727,4626,4524,4420,4316,4211,4106,4001,3896,3791,3686,3582,3478,3375},
{3417,3698,3959,4201,4425,4632,4823,4999,5160,5306,5440,5560,5668,5765,5850,5925,5989,6043,6087,6122,6149,6167,6176,6178,6173,6160,6140,6114,6081,6042,5998,5948,5893,5833,5768,5699,5626,5549,5469,5385,5298,5208,5116,5022,4925,4827,4727,4626,4523,4420,4316,4211,4106,4001,3895,3790,3686,3582,3478,3375},
{3548,3819,4071,4305,4522,4722,4906,5075,5230,5372,5500,5616,5720,5812,5894,5965,6026,6077,6119,6151,6175,6191,6198,6198,6191,6176,6155,6127,6093,6053,6007,5956,5900,5839,5774,5704,5630,5553,5472,5387,5300,5210,5117,5023,4926,4827,4727,4626,4523,4420,4315,4211,4106,4000,3895,3790,3685,3581,3478,3375},
{3674,3936,4180,4406,4615,4808,4986,5149,5299,5435,5559,5670,5770,5859,5937,6005,6062,6110,6149,6180,6201,6215,6220,6218,6209,6193,6170,6140,6105,6064,6017,5965,5908,5846,5779,5709,5634,5556,5475,5390,5302,5211,5119,5023,4926,4828,4727,4626,4523,4419,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375},
{3797,4050,4286,4504,4706,4892,5064,5222,5366,5497,5616,5724,5819,5904,5979,6043,6098,6143,6179,6207,6226,6238,6241,6237,6226,6208,6184,6153,6117,6074,6026,5973,5915,5852,5785,5714,5639,5560,5478,5392,5304,5213,5120,5024,4927,4828,4728,4626,4523,4419,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375},
{3916,4161,4388,4599,4794,4974,5140,5292,5431,5557,5672,5775,5867,5948,6020,6081,6133,6175,6209,6234,6251,6260,6262,6256,6244,6224,6198,6166,6128,6084,6035,5981,5922,5858,5791,5719,5643,5563,5481,5395,5306,5215,5121,5026,4928,4829,4728,4626,4523,4419,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375},
{4031,4267,4487,4691,4879,5053,5213,5360,5494,5616,5726,5825,5913,5991,6059,6117,6166,6206,6237,6260,6275,6282,6282,6274,6260,6239,6212,6178,6139,6094,6044,5989,5929,5865,5796,5723,5647,5567,5483,5397,5308,5216,5123,5027,4929,4829,4728,4626,4523,4419,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375},
{4142,4371,4583,4780,4962,5130,5284,5426,5555,5673,5779,5874,5958,6033,6098,6153,6199,6236,6265,6286,6299,6304,6302,6292,6276,6254,6225,6190,6150,6104,6053,5997,5936,5871,5801,5728,5651,5570,5486,5400,5310,5218,5124,5028,4930,4830,4729,4627,4524,4420,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375},
{4250,4470,4676,4866,5042,5204,5353,5490,5614,5727,5829,5921,6002,6073,6135,6187,6231,6265,6292,6310,6321,6324,6320,6310,6292,6268,6238,6202,6160,6113,6061,6004,5942,5876,5806,5732,5654,5573,5489,5402,5312,5220,5125,5029,4930,4831,4729,4627,4524,4420,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375},
{4353,4567,4765,4949,5119,5275,5419,5551,5671,5780,5879,5966,6044,6112,6171,6220,6261,6293,6318,6334,6343,6344,6339,6326,6307,6282,6250,6213,6170,6122,6069,6011,5949,5882,5811,5736,5658,5576,5492,5404,5314,5221,5126,5030,4931,4831,4730,4627,4524,4420,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375},
{4454,4660,4851,5029,5193,5344,5483,5611,5727,5831,5831,6010,6084,6149,6205,6252,6290,6320,6342,6357,6364,6363,6356,6342,6321,6295,6262,6224,6180,6131,6077,6018,5955,5887,5815,5740,5661,5579,5494,5406,5316,5223,5127,5030,4932,4832,4730,4628,4524,4420,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375},
{4550,4749,4935,5106,5265,5411,5545,5668,5780,5881,5971,6052,6123,6185,6238,6283,6319,6346,6366,6378,6384,6381,6373,6357,6335,6307,6273,6234,6189,6139,6084,6024,5960,5892,5820,5744,5664,5582,5496,5408,5317,5224,5128,5031,4932,4832,4730,4628,4524,4420,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375},
{4643,4836,5015,5180,5334,5475,5604,5723,5831,5928,6015,6093,6161,6220,6270,6312,6345,6371,6389,6399,6403,6399,6388,6371,6348,6319,6284,6243,6197,6146,6090,6030,5965,5896,5824,5747,5667,5584,5498,5410,5318,5225,5129,5032,4933,4832,4731,4628,4524,4420,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375},
{4732,4919,5092,5252,5400,5536,5661,5776,5879,5973,6057,6131,6196,6253,6300,6340,6371,6395,6410,6419,6421,6415,6403,6385,6360,6330,6293,6252,6205,6153,6096,6035,5970,5900,5827,5750,5670,5586,5500,5411,5319,5226,5130,5032,4933,4833,4731,4628,4524,4420,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375},
{4818,4998,5165,5320,5463,5595,5716,5826,5926,6016,6097,6168,6230,6284,6329,6366,6396,6417,6431,6438,6438,6431,6417,6397,6371,6340,6303,6260,6212,6159,6102,6040,5974,5904,5830,5753,5672,5588,5501,5412,5320,5226,5131,5033,4933,4833,4731,4628,4524,4420,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375},
{4900,5074,5236,5386,5524,5651,5768,5874,5971,6057,6135,6203,6263,6314,6357,6391,6419,6438,6450,6455,6453,6445,6430,6409,6382,6349,6311,6267,6219,6165,6107,6045,5978,5907,5833,5755,5674,5590,5503,5413,5321,5227,5131,5033,4934,4833,4731,4628,4524,4420,4315,4210,4105,4000,3895,3790,3685,3581,3478,3375}};
    
    int16 J1_2[61][60] = {{-841,-344,-125,-38,-8,5,20,47,91,152,229,323,430,550,680,821,969,1125,1286,1452,1622,1795,1971,2148,2327,2505,2684,2863,3040,3216,3391,3563,3733,3901,4065,4227,4385,4539,4690,4837,4980,5118,5252,5381,5506,5626,5741,5852,5957,6057,6153,6243,6328,6407,6482,6552,6616,6675,6729,6779},
{-1327,-701,-361,-176,-71,-2,53,109,171,244,329,426,534,653,781,918,1062,1213,1369,1530,1695,1863,2034,2206,2379,2552,2726,2900,3072,3244,3414,3582,3747,3911,4071,4229,4383,4533,4680,4823,4962,5097,5227,5353,5475,5592,5703,5811,5913,6010,6102,6189,6271,6348,6420,6487,6548,6605,6656,6703},
{-1646,-967,-558,-307,-146,-33,56,137,218,304,398,500,611,731,859,994,1136,1284,1437,1594,1755,1919,2085,2253,2421,2591,2761,2930,3098,3266,3431,3595,3757,3917,4073,4227,4377,4524,4668,4807,4943,5074,5202,5324,5442,5556,5665,5769,5868,5962,6052,6136,6215,6289,6358,6422,6481,6535,6584,6628},
{-1831,-1145,-704,-413,-214,-68,48,150,247,345,447,555,670,791,920,1055,1195,1341,1492,1646,1804,1965,2127,2291,2457,2622,2788,2954,3119,3282,3445,3605,3763,3919,4072,4223,4370,4513,4653,4790,4922,5050,5174,5294,5409,5520,5626,5727,5823,5915,6001,6083,6159,6230,6297,6358,6415,6466,6513,6554},
{-1916,-1250,-800,-489,-266,-98,38,156,267,375,484,598,716,840,970,1104,1244,1389,1538,1690,1845,2003,2163,2324,2486,2648,2811,2973,3135,3295,3454,3611,3766,3919,4069,4216,4360,4501,4638,4771,4900,5025,5147,5263,5376,5483,5586,5685,5778,5867,5951,6029,6103,6172,6236,6295,6349,6398,6442,6482},
{-1929,-1297,-854,-536,-301,-118,31,162,282,399,515,633,754,880,1011,1146,1285,1429,1576,1726,1880,2035,2192,2351,2510,2670,2830,2989,3147,3305,3461,3615,3767,3916,4063,4208,4348,4486,4620,4751,4877,5000,5118,5232,5341,5446,5547,5642,5733,5819,5900,5977,6048,6114,6176,6232,6284,6331,6372,6409},
{-1892,-1301,-873,-558,-318,-127,31,170,298,420,541,663,787,914,1046,1181,1320,1463,1609,1758,1909,2062,2217,2373,2530,2687,2845,3001,3157,3312,3465,3616,3765,3912,4056,4197,4336,4470,4602,4729,4853,4973,5088,5200,5307,5409,5507,5600,5688,5772,5850,5924,5993,6057,6116,6170,6219,6264,6303,6338},
{-1820,-1272,-866,-558,-319,-126,37,181,314,441,565,689,816,945,1077,1212,1351,1493,1637,1785,1934,2086,2239,2393,2547,2702,2857,3011,3164,3316,3466,3615,3762,3906,4047,4186,4321,4454,4582,4707,4828,4946,5059,5167,5272,5371,5467,5557,5643,5724,5800,5872,5938,6000,6057,6108,6155,6198,6235,6267},
{-1725,-1221,-838,-542,-308,-115,50,197,332,462,588,715,842,972,1104,1239,1378,1519,1662,1808,1956,2106,2257,2409,2561,2714,2866,3018,3169,3318,3466,3612,3757,3898,4037,4173,4306,4436,4562,4685,4803,4918,5028,5134,5236,5334,5426,5515,5598,5677,5751,5820,5884,5943,5998,6047,6092,6132,6167,6197},
{-1616,-1153,-795,-514,-286,-96,68,216,352,483,611,739,867,997,1129,1264,1402,1542,1685,1829,1976,2124,2273,2423,2573,2724,2874,3023,3172,3319,3465,3608,3750,3889,4026,4159,4290,4417,4541,4661,4777,4889,4997,5101,5201,5296,5386,5472,5553,5629,5701,5768,5830,5887,5939,5986,6029,6067,6100,6128},
{-1499,-1075,-742,-475,-256,-71,91,238,375,506,634,762,891,1021,1153,1287,1424,1563,1705,1848,1993,2139,2287,2435,2583,2731,2879,3027,3173,3318,3462,3603,3742,3879,4013,4145,4273,4398,4519,4637,4751,4861,4966,5068,5165,5258,5346,5429,5508,5582,5651,5716,5776,5831,5881,5881,5966,6002,6033,6059},
{-1378,-990,-681,-430,-220,-41,118,263,399,529,658,785,913,1043,1175,1308,1444,1582,1722,1864,2008,2153,2298,2445,2591,2738,2884,3029,3173,3316,3457,3596,3733,3868,4000,4129,4255,4378,4497,4612,4724,4831,4935,5034,5129,5219,5305,5386,5463,5535,5602,5664,5722,5775,5822,5866,5904,5938,5966,5991},
{-1257,-902,-616,-380,-180,-7,147,289,424,553,681,808,935,1064,1195,1328,1463,1600,1739,1879,2021,2164,2308,2453,2597,2742,2886,3029,3172,3312,3451,3589,3723,3856,3986,4113,4236,4357,4474,4587,4696,4802,4903,5000,5092,5181,5264,5343,5418,5488,5553,5613,5668,5719,5765,5806,5842,5873,5900,5923},
{-1137,-813,-548,-327,-137,28,178,317,449,578,704,830,956,1084,1214,1346,1480,1616,1753,1892,2033,2174,2317,2459,2602,2745,2887,3029,3169,3308,3445,3580,3713,3843,3971,4095,4217,4335,4450,4561,4668,4771,4870,4965,5056,5142,5223,5300,5373,5440,5503,5561,5614,5663,5707,5746,5780,5810,5835,5855},
{-1021,-724,-479,-272,-93,66,211,346,476,602,727,851,977,1104,1232,1363,1495,1630,1766,1904,2043,2183,2324,2465,2606,2747,2887,3027,3165,3302,3437,3570,3701,3829,3955,4077,4197,4313,4426,4535,4640,4741,4838,4930,5019,5103,5182,5257,5327,5393,5453,5510,5561,5607,5649,5686,5718,5746,5769,5788},
{-909,-638,-411,-217,-48,104,244,375,502,626,749,872,996,1122,1249,1379,1510,1643,1778,1914,2052,2190,2329,2469,2608,2747,2886,3023,3160,3295,3428,3559,3688,3814,3938,4059,4176,4290,4401,4508,4611,4710,4804,4895,4981,5063,5141,5213,5282,5345,5404,5458,5507,5552,5592,5627,5657,5683,5704,5720},
{-801,-554,-344,-163,-3,142,276,404,528,649,770,892,1015,1139,1265,1393,1523,1655,1788,1923,2059,2196,2333,2471,2609,2746,2883,3019,3153,3287,3418,3547,3674,3799,3920,4039,4154,4266,4375,4480,4581,4678,4771,4859,4944,5024,5099,5170,5236,5297,5354,5406,5453,5496,5534,5567,5596,5619,5639,5653},
{-700,-473,-279,-110,41,179,308,432,553,672,791,911,1032,1155,1279,1406,1534,1665,1797,1930,2065,2200,2336,2472,2608,2744,2879,3013,3146,3277,3407,3534,3659,3782,3902,4018,4132,4242,4349,4452,4551,4646,4737,4823,4906,4983,5057,5126,5190,5249,5304,5354,5400,5440,5476,5508,5534,5556,5574,5586},
{-604,-396,-217,-59,83,215,340,459,577,694,810,928,1048,1169,1292,1417,1545,1674,1804,1936,2069,2203,2338,2472,2607,2741,2874,3006,3138,3267,3395,3520,3644,3764,3882,3997,4109,4217,4322,4423,4520,4613,4702,4787,4867,4943,5014,5081,5143,5201,5254,5302,5346,5384,5419,5448,5473,5493,5509,5520},
{-514,-324,-158,-10,124,250,369,485,600,714,829,945,1062,1182,1304,1428,1553,1681,1810,1941,2072,2205,2338,2471,2604,2736,2868,2999,3128,3256,3382,3506,3627,3746,3862,3975,4085,4191,4294,4393,4488,4580,4667,4749,4828,4902,4971,5036,5097,5152,5203,5250,5291,5328,5361,5388,5411,5430,5443,5453},
{-430,-256,-102,36,163,282,397,510,621,733,845,959,1076,1194,1314,1436,1561,1687,1815,1944,2074,2205,2336,2468,2599,2730,2860,2989,3117,3243,3367,3490,3609,3726,3841,3952,4060,4165,4266,4363,4456,4546,4631,4712,4788,4860,4928,4991,5050,5104,5153,5197,5237,5272,5303,5328,5350,5366,5378,5386},
{-352,-192,-50,79,199,313,424,533,641,750,861,973,1087,1204,1323,1444,1566,1691,1818,1945,2074,2204,2334,2464,2594,2723,2852,2979,3105,3230,3352,3473,3591,3706,3819,3928,4034,4137,4236,4332,4423,4511,4594,4673,4748,4818,4884,4946,5002,5054,5102,5144,5182,5216,5244,5268,5288,5303,5313,5319},
{-280,-133,-2,119,233,342,448,553,659,766,874,984,1097,1212,1330,1449,1571,1694,1819,1946,2073,2201,2330,2458,2587,2714,2842,2967,3092,3215,3336,3455,3571,3685,3796,3903,4008,4109,4206,4300,4390,4475,4557,4634,4707,4776,4840,4899,4954,5004,5050,5091,5127,5159,5186,5208,5226,5239,5248,5252},
{-214,-79,43,156,264,368,470,572,675,779,886,994,1106,1219,1335,1453,1573,1696,1819,1944,2070,2197,2324,2451,2578,2705,2830,2955,3078,3199,3318,3435,3550,3662,3771,3877,3980,4080,4175,4267,4355,4439,4519,4595,4666,4733,4795,4853,4906,4954,4998,5037,5072,5102,5127,5148,5164,5175,5182,5185},
{-153,-30,84,190,292,391,490,589,689,791,896,1002,1112,1224,1339,1456,1574,1695,1818,1941,2066,2191,2317,2443,2569,2693,2818,2941,3062,3182,3300,3415,3528,3639,3746,3851,3952,4050,4144,4234,4320,4402,4481,4554,4624,4689,4749,4805,4857,4903,4946,4983,5016,5044,5068,5087,5101,5111,5117,5118},
{-99,15,120,220,317,412,507,603,701,801,904,1009,1117,1227,1341,1456,1574,1693,1814,1937,2060,2184,2309,2433,2557,2681,2804,2925,3045,3163,3280,3394,3505,3614,3720,3823,3923,4019,4111,4200,4284,4365,4441,4513,4581,4644,4703,4757,4807,4852,4893,4928,4960,4986,5008,5026,5038,5047,5051,5051},
{-49,55,153,247,339,430,522,615,711,809,909,1013,1120,1229,1341,1455,1571,1690,1810,1931,2053,2176,2299,2422,2545,2667,2788,2908,3027,3144,3259,3371,3481,3589,3693,3794,3892,3987,4077,4164,4247,4326,4401,4471,4538,4599,4656,4709,4757,4800,4839,4873,4903,4928,4928,4964,4975,4982,4985,4983},
{-6,91,182,270,358,445,534,625,718,814,913,1015,1120,1228,1339,1452,1567,1684,1803,1923,2044,2166,2287,2409,2531,2652,2772,2890,3008,3123,3236,3347,3456,3562,3665,3764,3861,3954,4043,4128,4210,4287,4360,4429,4493,4553,4609,4660,4706,4748,4785,4818,4846,4869,4888,4902,4912,4917,4918,4915},
{33,122,207,290,373,457,543,632,723,817,915,1016,1119,1226,1335,1447,1561,1677,1795,1914,2033,2154,2274,2395,2515,2635,2754,2871,2987,3101,3213,3322,3430,3534,3635,3733,3828,3920,4007,4091,4171,4247,4318,4385,4448,4507,4561,4610,4655,4695,4731,4762,4788,4810,4827,4840,4848,4852,4852,4847},
{67,148,228,307,386,467,550,636,726,818,914,1014,1116,1222,1330,1441,1554,1668,1785,1903,2021,2140,2260,2379,2498,2617,2734,2850,2965,3077,3188,3296,3402,3505,3605,3701,3795,3884,3971,4053,4131,4205,4275,4341,4402,4459,4512,4559,4603,4641,4675,4705,4730,4750,4766,4777,4784,4787,4785,4779},
{95,171,245,320,395,474,554,638,726,817,912,1010,1111,1215,1322,1432,1544,1658,1773,1890,2007,2125,2244,2362,2480,2597,2713,2828,2941,3053,3162,3269,3373,3474,3573,3668,3760,3848,3933,4014,4090,4163,4232,4296,4356,4411,4462,4508,4550,4587,4620,4647,4671,4690,4704,4714,4719,4721,4717,4710},
{119,189,258,329,402,477,556,638,724,813,907,1004,1104,1207,1313,1422,1533,1645,1760,1875,1992,2109,2226,2343,2460,2576,2691,2804,2916,3026,3134,3240,3343,3443,3540,3634,3724,3811,3894,3974,4049,4120,4187,4250,4308,4362,4411,4456,4496,4532,4563,4590,4612,4629,4642,4650,4655,4654,4650,4641},
{138,203,268,335,405,478,555,635,719,808,900,995,1094,1197,1302,1409,1519,1631,1744,1859,1974,2090,2207,2323,2438,2553,2667,2779,2890,2999,3105,3210,3311,3410,3506,3598,3687,3773,3855,3932,4006,4076,4141,4203,4259,4312,4360,4403,4442,4476,4506,4531,4552,4568,4579,4586,4589,4588,4582,4572},
{153,213,274,338,405,476,551,629,712,799,890,985,1083,1184,1288,1395,1504,1615,1727,1841,1955,2070,2186,2301,2415,2529,2641,2753,2862,2970,3075,3178,3278,3376,3470,3561,3649,3733,3814,3890,3963,4031,4095,4155,4210,4261,4308,4349,4387,4420,4448,4472,4491,4506,4516,4522,4523,4521,4514,4502},
{163,219,276,337,402,471,544,621,703,789,878,972,1069,1170,1273,1379,1487,1597,1708,1821,1935,2049,2163,2277,2390,2503,2614,2724,2833,2939,3043,3145,3244,3340,3434,3523,3610,3693,3772,3847,3918,3985,4047,4106,4160,4209,4254,4295,4331,4363,4389,4412,4430,4443,4452,4457,4457,4453,4445,4433},
{169,220,275,334,396,463,534,610,691,776,864,957,1053,1153,1256,1361,1468,1577,1688,1800,1912,2025,2138,2251,2364,2475,2586,2695,2802,2907,3010,3111,3209,3304,3396,3484,3569,3651,3728,3802,3872,3937,3999,4056,4109,4157,4200,4240,4274,4305,4330,4351,4368,4380,4388,4391,4390,4385,4376,4363},
{170,219,270,326,387,452,522,597,676,760,848,940,1036,1134,1236,1340,1447,1555,1665,1776,1888,2000,2112,2224,2336,2446,2556,2664,2770,2874,2976,3075,3172,3266,3356,3444,3527,3608,3684,3757,3825,3889,3949,4005,4056,4103,4146,4184,4217,4246,4270,4290,4306,4317,4323,4325,4323,4317,4307,4292},
{168,213,262,316,375,439,507,581,659,742,829,921,1015,1113,1214,1318,1424,1531,1641,1751,1862,1973,2084,2196,2306,2416,2524,2631,2736,2839,2940,3038,3134,3226,3316,3402,3484,3563,3639,3710,3777,3840,3899,3953,4003,4049,4090,4127,4159,4187,4210,4228,4243,4252,4258,4259,4256,4248,4237,4222},
{161,203,250,302,360,422,490,562,640,722,808,899,993,1091,1191,1294,1399,1506,1614,1724,1834,1944,2055,2165,2275,2383,2491,2597,2701,2803,2902,3000,3094,3186,3274,3359,3440,3518,3592,3662,3728,3789,3847,3900,3949,3993,4033,4069,4100,4126,4148,4166,4179,4188,4192,4192,4188,4179,4167,4151},
{151,190,235,286,341,403,469,541,618,699,785,875,969,1065,1165,1267,1372,1478,1586,1695,1804,1914,2023,2133,2242,2349,2456,2561,2664,2765,2864,2960,3053,3143,3231,3314,3395,3471,3544,3613,3677,3738,3794,3846,3894,3937,3976,4010,4040,4065,4086,4103,4115,4122,4126,4125,4119,4110,4097,4080},
{136,174,217,266,320,381,446,517,594,674,760,849,942,1038,1137,1239,1343,1449,1556,1664,1772,1881,1990,2099,2207,2314,2419,2523,2625,2726,2823,2918,3011,3100,3186,3269,3348,3423,3495,3562,3626,3685,3741,3791,3838,3880,3918,3951,3979,4004,4023,4039,4050,4056,4059,4057,4051,4040,4026,4008},
{118,154,195,243,296,356,421,491,567,647,732,821,913,1009,1108,1209,1312,1417,1524,1631,1739,1847,1956,2063,2170,2276,2381,2484,2586,2685,2781,2875,2967,3055,3140,3221,3299,3374,3444,3511,3573,3632,3686,3736,3781,3822,3858,3890,3918,3941,3960,3974,3984,3990,3991,3988,3981,3970,3955,3936},
{96,130,170,217,269,328,392,462,537,617,702,790,882,977,1076,1176,1279,1384,1490,1596,1704,1811,1919,2026,2132,2238,2341,2444,2544,2642,2738,2831,2921,3009,3093,3173,3250,3323,3393,3458,3520,3577,3630,3679,3723,3763,3798,3829,3856,3878,3896,3909,3918,3923,3923,3920,3912,3900,3884,3865},
{71,103,142,188,240,298,361,431,506,585,669,757,849,944,1042,1142,1244,1348,1454,1560,1667,1774,1880,1987,2092,2197,2300,2401,2501,2598,2693,2785,2875,2961,3044,3123,3199,3272,3340,3404,3465,3521,3573,3621,3664,3703,3737,3767,3793,3814,3831,3843,3852,3856,3855,3851,3842,3830,3813,3793},
{41,73,111,156,207,264,328,397,471,551,634,722,813,908,1005,1105,1207,1311,1416,1521,1628,1734,1840,1946,2051,2155,2257,2358,2456,2553,2647,2738,2826,2912,2994,3072,3147,3219,3286,3349,3409,3464,3515,3562,3604,3642,3676,3705,3729,3750,3766,3777,3784,3788,3786,3781,3772,3759,3742,3721},
{9,39,77,121,171,229,292,361,435,514,597,685,776,870,967,1067,1168,1272,1376,1481,1587,1693,1798,1903,2008,2111,2212,2312,2410,2506,2599,2689,2777,2861,2942,3020,3094,3164,3231,3293,3352,3406,3456,3502,3543,3580,3613,3641,3665,3684,3700,3710,3717,3719,3717,3711,3701,3688,3670,3648},
{-27,2,39,83,133,190,253,322,396,474,558,645,736,830,927,1026,1127,1230,1334,1439,1544,1649,1755,1859,1963,2065,2166,2265,2362,2457,2549,2639,2726,2809,2889,2966,3039,3109,3174,3236,3294,3347,3396,3441,3481,3518,3549,3577,3600,3618,3633,3643,3649,3650,3648,3641,3631,3616,3598,3576},
{-66,-37,-1,42,92,149,212,280,354,433,516,603,694,788,885,984,1085,1187,1291,1395,1500,1604,1709,1813,1916,2017,2118,2216,2313,2407,2498,2587,2673,2756,2835,2911,2984,3052,3117,3177,3234,3287,3335,3379,3419,3454,3485,3512,3534,3552,3565,3575,3580,3581,3578,3571,3560,3545,3526,3504},
{-109,-80,-45,-1,49,105,168,237,310,389,472,559,650,744,840,939,1040,1142,1245,1349,1453,1558,1662,1765,1867,1969,2068,2166,2262,2355,2446,2534,2619,2701,2780,2855,2926,2994,3058,3118,3174,3225,3273,3316,3355,3390,3420,3446,3467,3485,3498,3506,3511,3511,3508,3500,3489,3473,3454,3431},
{-155,-127,-91,-48,2,59,122,190,264,343,426,513,604,697,794,892,993,1095,1198,1301,1405,1509,1613,1715,1817,1918,2017,2114,2209,2302,2392,2479,2564,2645,2723,2797,2868,2935,2998,3057,3112,3163,3210,3252,3290,3324,3354,3379,3400,3417,3429,3437,3441,3441,3437,3429,3417,3401,3382,3359},
{-203,-176,-140,-97,-47,10,73,142,216,294,378,465,555,649,745,844,944,1045,1148,1251,1355,1459,1562,1664,1765,1866,1964,2061,2155,2247,2337,2423,2507,2587,2665,2738,2808,2875,2937,2995,3050,3100,3146,3188,3225,3258,3287,3312,3332,3348,3360,3368,3371,3371,3366,3358,3346,3330,3310,3287},
{-255,-228,-192,-149,-98,-41,22,91,165,244,327,414,505,598,694,793,893,994,1097,1200,1303,1406,1509,1611,1712,1811,1909,2005,2099,2191,2280,2366,2449,2529,2605,2678,2747,2813,2875,2932,2986,3036,3081,3122,3159,3192,3220,3244,3264,3279,3291,3298,3301,3300,3295,3287,3274,3258,3238,3215},
{-311,-283,-247,-203,-153,-95,-32,37,112,191,274,361,452,546,642,740,840,941,1044,1147,1249,1352,1455,1556,1657,1756,1853,1949,2042,2133,2221,2307,2389,2468,2544,2617,2685,2750,2811,2868,2921,2970,3015,3056,3092,3124,3152,3175,3195,3210,3221,3228,3230,3229,3224,3215,3202,3186,3166,3142},
{-369,-340,-304,-260,-209,-152,-88,-19,56,135,219,307,397,491,587,685,785,887,989,1091,1194,1297,1399,1500,1600,1699,1795,1890,1983,2074,2161,2246,2328,2407,2482,2554,2622,2686,2747,2803,2856,2904,2948,2988,3024,3056,3083,3106,3125,3140,3150,3157,3159,3158,3153,3143,3131,3114,3094,3070},
{-430,-401,-364,-320,-269,-211,-146,-77,-2,78,162,250,341,434,531,629,729,830,932,1034,1137,1239,1341,1442,1541,1640,1736,1831,1923,2013,2100,2185,2266,2344,2419,2490,2557,2621,2681,2737,2789,2837,2881,2920,2956,2987,3014,3036,3055,3069,3080,3086,3088,3087,3081,3072,3059,3042,3022,2999},
{-493,-464,-427,-382,-330,-272,-207,-137,-62,18,18,191,282,376,472,570,670,771,873,975,1078,1180,1281,1382,1481,1579,1675,1769,1861,1951,2037,2121,2202,2280,2354,2425,2492,2555,2615,2670,2722,2769,2812,2851,2886,2917,2944,2966,2984,2998,3009,3015,3017,3015,3009,3000,2987,2971,2950,2927},
{-560,-530,-492,-447,-395,-335,-270,-200,-124,-43,41,129,221,315,411,510,610,711,812,915,1017,1119,1220,1320,1419,1517,1613,1707,1798,1887,1973,2057,2137,2214,2288,2358,2425,2488,2547,2602,2653,2700,2743,2782,2816,2847,2873,2895,2913,2927,2937,2943,2945,2943,2938,2928,2915,2899,2879,2856},
{-629,-599,-560,-514,-461,-401,-336,-264,-188,-107,-22,66,158,252,349,447,547,648,750,852,954,1056,1157,1257,1356,1453,1549,1642,1733,1822,1908,1991,2071,2148,2221,2291,2357,2420,2478,2533,2584,2630,2673,2711,2746,2776,2802,2824,2842,2856,2865,2871,2873,2871,2866,2857,2844,2828,2808,2785},
{-702,-670,-631,-584,-530,-470,-403,-331,-255,-173,-88,1,93,188,284,383,483,584,686,788,890,992,1092,1192,1291,1388,1483,1576,1667,1756,1841,1924,2004,2080,2153,2222,2288,2350,2409,2463,2513,2560,2602,2640,2674,2704,2730,2752,2770,2784,2793,2799,2801,2800,2794,2785,2772,2756,2737,2714},
{-776,-744,-704,-656,-602,-540,-473,-401,-323,-241,-156,-66,26,121,218,317,417,518,620,722,824,925,1026,1126,1224,1321,1416,1509,1600,1688,1773,1855,1935,2011,2084,2153,2218,2280,2338,2392,2442,2488,2530,2569,2602,2632,2658,2680,2698,2711,2721,2727,2729,2728,2722,2714,2701,2685,2666,2644},
{-854,-821,-779,-731,-675,-613,-545,-472,-394,-312,-225,-135,-43,53,150,249,349,451,552,654,756,858,958,1058,1156,1253,1348,1440,1531,1619,1704,1786,1865,1941,2013,2082,2147,2209,2267,2320,2370,2416,2458,2496,2530,2560,2586,2607,2625,2639,2649,2655,2657,2656,2651,2642,2630,2615,2596,2574}};
    
    int16 J2_1[61][60] = {{12843,12605,12056,11358,10602,9836,9088,8371,7691,7049,6445,5878,5345,4844,4372,3927,3507,3109,2732,2374,2033,1708,1398,1102,818,546,285,33,-208,-441,-666,-882,-1092,-1294,-1490,-1679,-1863,-2041,-2213,-2380,-2542,-2699,-2852,-2999,-3143,-3282,-3417,-3548,-3674,-3797,-3916,-4031,-4142,-4250,-4353,-4454,-4550,-4643,-4732,-4818},
{8645,8841,8703,8372,7934,7441,6926,6409,5901,5408,4934,4480,4046,3633,3240,2865,2508,2167,1842,1531,1233,948,675,412,160,-83,-317,-543,-760,-971,-1174,-1371,-1561,-1745,-1924,-2098,-2266,-2429,-2587,-2741,-2890,-3035,-3175,-3312,-3444,-3573,-3698,-3819,-3936,-4050,-4161,-4267,-4371,-4470,-4567,-4660,-4749,-4836,-4919,-4998},
{5434,5868,5985,5898,5684,5393,5056,4695,4324,3952,3584,3225,2876,2538,2212,1898,1597,1306,1027,758,499,249,9,-223,-447,-664,-873,-1075,-1271,-1461,-1645,-1823,-1996,-2164,-2327,-2485,-2639,-2789,-2934,-3075,-3213,-3346,-3476,-3602,-3724,-3843,-3959,-4071,-4180,-4286,-4388,-4487,-4583,-4676,-4765,-4851,-4935,-5015,-5092,-5165},
{2944,3501,3772,3846,3789,3643,3440,3200,2938,2663,2383,2102,1824,1551,1283,1022,768,521,282,50,-175,-392,-603,-808,-1006,-1199,-1385,-1566,-1743,-1913,-2080,-2241,-2398,-2551,-2700,-2844,-2985,-3122,-3256,-3385,-3512,-3635,-3754,-3871,-3984,-4094,-4201,-4305,-4406,-4504,-4599,-4691,-4780,-4866,-4949,-5029,-5106,-5180,-5252,-5320},
{987,1599,1958,2138,2188,2148,2045,1898,1721,1525,1316,1100,881,662,443,227,15,-193,-397,-596,-791,-980,-1165,-1345,-1520,-1691,-1857,-2020,-2177,-2331,-2481,-2628,-2770,-2909,-3044,-3176,-3305,-3431,-3553,-3672,-3789,-3902,-4012,-4120,-4225,-4326,-4425,-4522,-4615,-4706,-4794,-4879,-4962,-5042,-5119,-5193,-5265,-5334,-5400,-5463},
{-574,54,462,708,832,868,839,763,653,519,368,206,37,-138,-314,-491,-668,-843,-1016,-1186,-1354,-1518,-1679,-1837,-1992,-2144,-2292,-2436,-2578,-2716,-2852,-2984,-3113,-3239,-3363,-3483,-3601,-3716,-3828,-3938,-4045,-4149,-4251,-4350,-4447,-4541,-4632,-4722,-4808,-4892,-4974,-5053,-5130,-5204,-5275,-5344,-5411,-5475,-5536,-5595},
{-1834,-1213,-781,-496,-322,-232,-206,-227,-285,-369,-473,-591,-720,-856,-996,-1140,-1286,-1432,-1578,-1723,-1867,-2010,-2150,-2289,-2425,-2559,-2691,-2820,-2947,-3071,-3193,-3312,-3429,-3544,-3656,-3766,-3874,-3979,-4082,-4183,-4281,-4377,-4471,-4562,-4652,-4739,-4823,-4906,-4986,-5064,-5140,-5213,-5284,-5353,-5419,-5483,-5545,-5604,-5661,-5716},
{-2864,-2261,-1823,-1514,-1308,-1180,-1113,-1093,-1110,-1154,-1220,-1302,-1397,-1501,-1611,-1727,-1846,-1967,-2090,-2213,-2336,-2459,-2581,-2702,-2821,-2940,-3057,-3172,-3285,-3397,-3506,-3614,-3720,-3824,-3926,-4027,-4125,-4221,-4315,-4408,-4498,-4587,-4673,-4758,-4840,-4920,-4999,-5075,-5149,-5222,-5292,-5360,-5426,-5490,-5551,-5611,-5668,-5723,-5776,-5826},
{-3713,-3135,-2700,-2381,-2154,-1999,-1902,-1851,-1836,-1849,-1884,-1937,-2003,-2080,-2165,-2256,-2352,-2452,-2554,-2658,-2763,-2868,-2974,-3079,-3184,-3288,-3392,-3494,-3595,-3695,-3794,-3891,-3987,-4082,-4174,-4266,-4355,-4444,-4530,-4615,-4698,-4779,-4859,-4937,-5013,-5087,-5160,-5230,-5299,-5366,-5431,-5494,-5555,-5614,-5671,-5727,-5780,-5831,-5879,-5926},
{-4421,-3870,-3444,-3121,-2882,-2710,-2591,-2516,-2476,-2464,-2475,-2503,-2546,-2600,-2663,-2734,-2810,-2891,-2975,-3062,-3151,-3241,-3332,-3424,-3515,-3607,-3698,-3789,-3880,-3969,-4058,-4145,-4232,-4318,-4402,-4485,-4567,-4647,-4726,-4804,-4880,-4955,-5029,-5100,-5171,-5239,-5306,-5372,-5435,-5497,-5557,-5616,-5673,-5727,-5780,-5831,-5881,-5928,-5973,-6016},
{-5014,-4491,-4078,-3757,-3511,-3327,-3194,-3101,-3042,-3010,-3000,-3008,-3032,-3067,-3112,-3165,-3224,-3289,-3357,-3429,-3504,-3580,-3659,-3738,-3818,-3898,-3978,-4059,-4139,-4219,-4299,-4378,-4456,-4533,-4610,-4685,-4760,-4833,-4906,-4977,-5047,-5116,-5183,-5250,-5314,-5378,-5440,-5500,-5559,-5616,-5672,-5726,-5779,-5829,-5879,-5879,-5971,-6015,-6057,-6097},
{-5514,-5019,-4621,-4305,-4057,-3866,-3721,-3615,-3541,-3493,-3467,-3460,-3466,-3486,-3515,-3553,-3598,-3648,-3703,-3762,-3824,-3889,-3955,-4023,-4093,-4163,-4233,-4305,-4376,-4447,-4518,-4589,-4660,-4730,-4799,-4868,-4936,-5003,-5069,-5134,-5199,-5262,-5324,-5385,-5444,-5503,-5560,-5616,-5670,-5724,-5775,-5825,-5874,-5921,-5966,-6010,-6052,-6093,-6131,-6168},
{-5937,-5469,-5087,-4778,-4531,-4335,-4183,-4068,-3982,-3922,-3883,-3862,-3855,-3861,-3877,-3902,-3934,-3972,-4016,-4063,-4114,-4168,-4224,-4282,-4342,-4403,-4465,-4528,-4591,-4654,-4718,-4782,-4845,-4908,-4971,-5033,-5095,-5156,-5217,-5277,-5335,-5394,-5451,-5507,-5562,-5616,-5668,-5720,-5770,-5819,-5867,-5913,-5958,-6002,-6044,-6084,-6123,-6161,-6196,-6230},
{-6298,-5854,-5487,-5187,-4943,-4746,-4589,-4466,-4372,-4303,-4253,-4221,-4203,-4197,-4202,-4216,-4237,-4265,-4298,-4335,-4376,-4421,-4468,-4517,-4568,-4621,-4675,-4730,-4786,-4842,-4899,-4956,-5013,-5070,-5126,-5183,-5239,-5295,-5350,-5405,-5459,-5512,-5564,-5616,-5667,-5716,-5765,-5812,-5859,-5904,-5948,-5991,-6033,-6073,-6112,-6149,-6185,-6220,-6253,-6284},
{-6604,-6184,-5833,-5541,-5301,-5105,-4945,-4818,-4717,-4639,-4581,-4540,-4513,-4498,-4493,-4497,-4509,-4527,-4551,-4580,-4612,-4648,-4687,-4729,-4772,-4818,-4865,-4913,-4962,-5011,-5062,-5113,-5164,-5215,-5266,-5317,-5368,-5419,-5469,-5519,-5569,-5617,-5665,-5713,-5759,-5805,-5850,-5894,-5937,-5979,-6020,-6059,-6098,-6135,-6171,-6205,-6238,-6270,-6300,-6329},
{-6865,-6467,-6130,-5848,-5613,-5418,-5257,-5127,-5021,-4938,-4873,-4824,-4789,-4766,-4753,-4749,-4753,-4763,-4779,-4800,-4825,-4853,-4885,-4919,-4956,-4995,-5035,-5077,-5120,-5163,-5208,-5253,-5299,-5345,-5391,-5437,-5484,-5530,-5575,-5621,-5666,-5711,-5755,-5798,-5841,-5883,-5925,-5965,-6005,-6043,-6081,-6117,-6153,-6187,-6220,-6252,-6283,-6312,-6340,-6366},
{-7087,-6708,-6387,-6114,-5884,-5691,-5531,-5398,-5289,-5201,-5131,-5076,-5034,-5005,-4985,-4974,-4970,-4974,-4982,-4996,-5014,-5036,-5062,-5090,-5120,-5153,-5187,-5223,-5261,-5299,-5338,-5379,-5419,-5460,-5502,-5544,-5585,-5627,-5669,-5710,-5751,-5792,-5833,-5873,-5912,-5951,-5989,-6026,-6062,-6098,-6133,-6166,-6199,-6231,-6261,-6290,-6319,-6345,-6371,-6396},
{-7274,-6915,-6606,-6343,-6119,-5929,-5769,-5635,-5524,-5433,-5358,-5298,-5252,-5216,-5190,-5173,-5164,-5161,-5164,-5171,-5184,-5200,-5219,-5241,-5266,-5294,-5323,-5354,-5386,-5419,-5454,-5489,-5526,-5562,-5599,-5637,-5675,-5712,-5750,-5788,-5825,-5863,-5900,-5936,-5972,-6008,-6043,-6077,-6110,-6143,-6175,-6206,-6236,-6265,-6293,-6320,-6346,-6371,-6395,-6417},
{-7432,-7090,-6794,-6540,-6321,-6135,-5977,-5843,-5730,-5636,-5558,-5494,-5443,-5403,-5372,-5350,-5335,-5327,-5324,-5326,-5333,-5344,-5358,-5376,-5395,-5418,-5442,-5468,-5496,-5525,-5555,-5586,-5618,-5651,-5684,-5718,-5752,-5786,-5820,-5854,-5888,-5922,-5956,-5990,-6023,-6055,-6087,-6119,-6149,-6179,-6209,-6237,-6265,-6292,-6318,-6342,-6366,-6389,-6410,-6431},
{-7563,-7237,-6953,-6708,-6496,-6313,-6156,-6023,-5909,-5813,-5732,-5666,-5611,-5567,-5532,-5505,-5485,-5472,-5465,-5463,-5465,-5471,-5481,-5493,-5509,-5526,-5546,-5568,-5592,-5617,-5643,-5670,-5698,-5727,-5757,-5787,-5817,-5848,-5879,-5910,-5941,-5972,-6003,-6033,-6063,-6093,-6122,-6151,-6180,-6207,-6234,-6260,-6286,-6310,-6334,-6357,-6378,-6399,-6419,-6438},
{-7671,-7360,-7087,-6850,-6644,-6465,-6311,-6178,-6064,-5967,-5884,-5815,-5757,-5709,-5671,-5640,-5617,-5600,-5588,-5582,-5579,-5581,-5587,-5595,-5607,-5621,-5637,-5655,-5674,-5695,-5718,-5742,-5766,-5792,-5818,-5845,-5872,-5899,-5927,-5955,-5983,-6011,-6039,-6067,-6095,-6122,-6149,-6175,-6201,-6226,-6251,-6275,-6299,-6321,-6343,-6364,-6384,-6403,-6421,-6438},
{-7758,-7460,-7198,-6969,-6769,-6594,-6442,-6310,-6196,-6098,-6014,-5943,-5883,-5832,-5791,-5757,-5730,-5709,-5694,-5684,-5678,-5676,-5678,-5683,-5691,-5701,-5713,-5728,-5744,-5762,-5781,-5801,-5823,-5845,-5868,-5892,-5916,-5941,-5966,-5991,-6016,-6042,-6067,-6092,-6117,-6142,-6167,-6191,-6215,-6238,-6260,-6282,-6304,-6324,-6344,-6363,-6381,-6399,-6415,-6431},
{-7826,-7541,-7289,-7067,-6872,-6702,-6552,-6422,-6309,-6210,-6125,-6052,-5990,-5937,-5893,-5857,-5827,-5803,-5785,-5771,-5762,-5757,-5755,-5757,-5761,-5768,-5777,-5788,-5801,-5816,-5832,-5849,-5868,-5887,-5908,-5928,-5950,-5972,-5994,-6017,-6040,-6063,-6086,-6109,-6132,-6154,-6176,-6198,-6220,-6241,-6262,-6282,-6302,-6320,-6339,-6356,-6373,-6388,-6403,-6417},
{-7876,-7603,-7361,-7146,-6957,-6790,-6643,-6515,-6402,-6304,-6218,-6144,-6080,-6026,-5979,-5940,-5908,-5881,-5860,-5844,-5832,-5824,-5819,-5818,-5819,-5823,-5829,-5837,-5848,-5859,-5873,-5887,-5903,-5920,-5937,-5955,-5974,-5994,-6014,-6034,-6055,-6075,-6096,-6117,-6138,-6158,-6178,-6198,-6218,-6237,-6256,-6274,-6292,-6310,-6326,-6342,-6357,-6371,-6385,-6397},
{-7911,-7649,-7415,-7208,-7024,-6861,-6717,-6590,-6478,-6380,-6294,-6219,-6154,-6098,-6050,-6009,-5974,-5946,-5922,-5903,-5888,-5878,-5870,-5866,-5865,-5866,-5870,-5875,-5883,-5892,-5903,-5915,-5928,-5942,-5957,-5973,-5990,-6007,-6025,-6043,-6061,-6080,-6098,-6117,-6136,-6154,-6173,-6191,-6209,-6226,-6244,-6260,-6276,-6292,-6307,-6321,-6335,-6348,-6360,-6371},
{-7931,-7679,-7454,-7253,-7074,-6915,-6774,-6649,-6538,-6441,-6355,-6280,-6214,-6156,-6107,-6064,-6027,-5996,-5971,-5949,-5933,-5919,-5910,-5903,-5899,-5898,-5899,-5903,-5908,-5914,-5923,-5932,-5943,-5955,-5968,-5982,-5996,-6012,-6027,-6043,-6059,-6076,-6093,-6110,-6126,-6143,-6160,-6176,-6193,-6208,-6224,-6239,-6254,-6268,-6282,-6295,-6307,-6319,-6330,-6340},
{-7938,-7696,-7478,-7284,-7110,-6954,-6816,-6693,-6584,-6487,-6401,-6326,-6259,-6201,-6150,-6105,-6067,-6035,-6007,-5984,-5965,-5950,-5938,-5929,-5923,-5920,-5919,-5920,-5923,-5927,-5933,-5941,-5950,-5960,-5971,-5982,-5995,-6008,-6022,-6036,-6050,-6065,-6080,-6095,-6110,-6125,-6140,-6155,-6170,-6184,-6198,-6212,-6225,-6238,-6250,-6262,-6273,-6284,-6293,-6303},
{-7933,-7699,-7489,-7300,-7131,-6980,-6844,-6723,-6615,-6519,-6434,-6358,-6291,-6232,-6180,-6135,-6095,-6061,-6032,-6007,-5986,-5969,-5956,-5945,-5937,-5932,-5929,-5928,-5928,-5931,-5935,-5941,-5948,-5956,-5965,-5974,-5985,-5996,-6008,-6021,-6033,-6046,-6060,-6073,-6087,-6100,-6114,-6127,-6140,-6153,-6166,-6178,-6190,-6202,-6213,-6224,-6234,-6243,-6252,-6260},
{-7916,-7691,-7488,-7305,-7140,-6992,-6860,-6741,-6634,-6539,-6454,-6378,-6311,-6252,-6199,-6152,-6112,-6076,-6046,-6020,-5997,-5979,-5963,-5951,-5941,-5934,-5929,-5926,-5925,-5926,-5929,-5932,-5937,-5944,-5951,-5959,-5968,-5978,-5988,-5998,-6010,-6021,-6033,-6045,-6057,-6069,-6081,-6093,-6105,-6117,-6128,-6139,-6150,-6160,-6170,-6180,-6189,-6197,-6205,-6212},
{-7889,-7671,-7474,-7297,-7137,-6993,-6863,-6746,-6641,-6547,-6463,-6387,-6320,-6260,-6207,-6159,-6118,-6081,-6050,-6022,-5998,-5978,-5961,-5947,-5936,-5927,-5921,-5916,-5914,-5913,-5914,-5916,-5919,-5924,-5930,-5936,-5944,-5952,-5960,-5970,-5979,-5989,-6000,-6010,-6021,-6032,-6042,-6053,-6064,-6074,-6084,-6094,-6104,-6113,-6122,-6131,-6139,-6146,-6153,-6159},
{-7851,-7641,-7451,-7278,-7122,-6982,-6854,-6740,-6636,-6543,-6460,-6385,-6318,-6257,-6204,-6156,-6114,-6076,-6044,-6015,-5990,-5969,-5950,-5935,-5922,-5912,-5904,-5898,-5894,-5892,-5891,-5892,-5894,-5897,-5901,-5906,-5912,-5919,-5926,-5934,-5942,-5951,-5960,-5969,-5979,-5988,-5998,-6007,-6017,-6026,-6035,-6044,-6053,-6061,-6069,-6077,-6084,-6090,-6096,-6102},
{-7804,-7601,-7417,-7249,-7098,-6960,-6836,-6723,-6622,-6530,-6447,-6372,-6305,-6245,-6191,-6143,-6100,-6062,-6028,-5999,-5973,-5950,-5931,-5914,-5901,-5889,-5880,-5873,-5867,-5864,-5862,-5861,-5862,-5863,-5866,-5870,-5875,-5880,-5886,-5893,-5900,-5907,-5915,-5923,-5931,-5939,-5948,-5956,-5965,-5973,-5981,-5989,-5997,-6004,-6011,-6018,-6024,-6030,-6035,-6040},
{-7749,-7552,-7373,-7211,-7063,-6929,-6807,-6697,-6597,-6506,-6424,-6350,-6284,-6224,-6170,-6121,-6078,-6039,-6005,-5974,-5947,-5924,-5904,-5886,-5871,-5859,-5848,-5840,-5833,-5828,-5825,-5823,-5823,-5823,-5825,-5827,-5831,-5835,-5840,-5845,-5851,-5857,-5864,-5871,-5878,-5885,-5893,-5900,-5908,-5915,-5922,-5929,-5936,-5942,-5949,-5955,-5960,-5965,-5970,-5974},
{-7685,-7495,-7321,-7163,-7019,-6888,-6769,-6661,-6563,-6474,-6393,-6320,-6253,-6193,-6139,-6091,-6047,-6008,-5973,-5942,-5914,-5890,-5869,-5850,-5834,-5821,-5809,-5800,-5792,-5786,-5782,-5779,-5777,-5777,-5777,-5779,-5781,-5784,-5788,-5792,-5797,-5802,-5808,-5814,-5820,-5826,-5833,-5839,-5846,-5852,-5858,-5865,-5871,-5876,-5882,-5887,-5892,-5896,-5900,-5904},
{-7613,-7429,-7261,-7107,-6967,-6839,-6723,-6617,-6520,-6432,-6353,-6280,-6214,-6155,-6101,-6052,-6008,-5969,-5933,-5902,-5874,-5849,-5827,-5807,-5791,-5776,-5764,-5754,-5745,-5738,-5733,-5729,-5726,-5725,-5724,-5725,-5726,-5728,-5731,-5734,-5738,-5742,-5747,-5752,-5757,-5763,-5768,-5774,-5779,-5785,-5791,-5796,-5801,-5806,-5811,-5815,-5820,-5824,-5827,-5830},
{-7534,-7356,-7193,-7043,-6907,-6782,-6668,-6564,-6470,-6383,-6304,-6233,-6168,-6108,-6055,-6006,-5962,-5922,-5887,-5855,-5826,-5801,-5778,-5758,-5741,-5725,-5712,-5701,-5692,-5684,-5678,-5673,-5669,-5667,-5665,-5665,-5665,-5667,-5668,-5671,-5674,-5677,-5681,-5685,-5690,-5694,-5699,-5704,-5709,-5714,-5719,-5723,-5728,-5732,-5736,-5740,-5744,-5747,-5750,-5753},
{-7449,-7276,-7117,-6972,-6839,-6717,-6606,-6504,-6411,-6326,-6249,-6178,-6113,-6055,-6001,-5953,-5909,-5869,-5833,-5801,-5772,-5746,-5723,-5703,-5684,-5669,-5655,-5643,-5633,-5624,-5617,-5612,-5607,-5604,-5602,-5601,-5600,-5601,-5602,-5603,-5605,-5608,-5611,-5615,-5618,-5622,-5626,-5630,-5634,-5639,-5643,-5647,-5651,-5654,-5658,-5661,-5664,-5667,-5670,-5672},
{-7357,-7189,-7035,-6894,-6764,-6645,-6537,-6437,-6346,-6262,-6186,-6116,-6052,-5994,-5941,-5893,-5849,-5810,-5774,-5741,-5712,-5686,-5662,-5641,-5623,-5606,-5592,-5579,-5569,-5559,-5552,-5545,-5540,-5536,-5533,-5531,-5530,-5530,-5530,-5531,-5533,-5535,-5537,-5540,-5543,-5546,-5549,-5553,-5556,-5560,-5563,-5567,-5570,-5573,-5576,-5579,-5582,-5584,-5586,-5588},
{-7258,-7096,-6946,-6809,-6683,-6567,-6461,-6363,-6274,-6192,-6117,-6048,-5985,-5927,-5875,-5827,-5784,-5744,-5708,-5675,-5646,-5619,-5596,-5574,-5555,-5538,-5524,-5511,-5499,-5490,-5481,-5474,-5469,-5464,-5460,-5458,-5456,-5455,-5455,-5455,-5456,-5457,-5459,-5461,-5463,-5466,-5469,-5472,-5475,-5478,-5481,-5483,-5486,-5489,-5492,-5494,-5496,-5498,-5500,-5501},
{-7155,-6997,-6852,-6718,-6595,-6482,-6378,-6283,-6195,-6115,-6041,-5973,-5911,-5855,-5803,-5755,-5712,-5673,-5637,-5604,-5575,-5548,-5524,-5502,-5483,-5466,-5451,-5437,-5425,-5415,-5406,-5399,-5393,-5388,-5383,-5380,-5378,-5376,-5376,-5375,-5375,-5376,-5377,-5379,-5381,-5383,-5385,-5387,-5390,-5392,-5395,-5397,-5400,-5402,-5404,-5406,-5408,-5410,-5411,-5412},
{-7046,-6892,-6751,-6621,-6502,-6392,-6290,-6197,-6111,-6032,-5960,-5893,-5832,-5776,-5725,-5678,-5635,-5596,-5560,-5528,-5498,-5471,-5447,-5426,-5406,-5389,-5373,-5359,-5347,-5337,-5327,-5319,-5313,-5307,-5303,-5299,-5296,-5294,-5293,-5292,-5292,-5292,-5293,-5293,-5295,-5296,-5298,-5300,-5302,-5304,-5306,-5308,-5310,-5312,-5314,-5316,-5317,-5318,-5319,-5320},
{-6932,-6783,-6646,-6519,-6403,-6296,-6197,-6105,-6022,-5944,-5873,-5808,-5748,-5693,-5642,-5596,-5553,-5514,-5479,-5447,-5417,-5390,-5366,-5344,-5325,-5307,-5291,-5277,-5265,-5254,-5245,-5236,-5229,-5223,-5218,-5214,-5211,-5208,-5207,-5205,-5205,-5204,-5205,-5205,-5206,-5207,-5208,-5210,-5211,-5213,-5215,-5216,-5218,-5220,-5221,-5223,-5224,-5225,-5226,-5226},
{-6813,-6669,-6535,-6413,-6299,-6195,-6098,-6009,-5927,-5851,-5782,-5718,-5658,-5604,-5554,-5509,-5467,-5428,-5393,-5361,-5332,-5305,-5281,-5259,-5239,-5222,-5206,-5192,-5179,-5168,-5158,-5150,-5142,-5136,-5131,-5126,-5123,-5120,-5117,-5116,-5115,-5114,-5114,-5114,-5115,-5115,-5116,-5117,-5119,-5120,-5121,-5123,-5124,-5125,-5126,-5127,-5128,-5129,-5130,-5131},
{-6690,-6550,-6421,-6301,-6191,-6089,-5995,-5908,-5828,-5754,-5685,-5623,-5565,-5511,-5462,-5417,-5376,-5338,-5303,-5271,-5242,-5216,-5192,-5170,-5150,-5133,-5117,-5102,-5090,-5078,-5068,-5060,-5052,-5045,-5040,-5035,-5031,-5028,-5026,-5024,-5022,-5021,-5021,-5021,-5021,-5021,-5022,-5023,-5023,-5024,-5026,-5027,-5028,-5029,-5030,-5030,-5031,-5032,-5032,-5033},
{-6563,-6427,-6301,-6185,-6078,-5979,-5887,-5802,-5724,-5652,-5585,-5523,-5467,-5414,-5366,-5322,-5281,-5244,-5209,-5178,-5149,-5123,-5099,-5078,-5058,-5040,-5024,-5010,-4997,-4986,-4976,-4967,-4959,-4952,-4947,-4942,-4937,-4934,-4931,-4929,-4927,-4926,-4925,-4925,-4925,-4925,-4925,-4926,-4926,-4927,-4928,-4929,-4930,-4930,-4931,-4932,-4932,-4933,-4933,-4933},
{-6432,-6300,-6178,-6066,-5961,-5865,-5775,-5693,-5616,-5546,-5480,-5420,-5365,-5313,-5266,-5223,-5183,-5146,-5112,-5081,-5053,-5027,-5003,-4982,-4963,-4945,-4929,-4915,-4902,-4890,-4880,-4871,-4864,-4857,-4851,-4846,-4841,-4838,-4835,-4832,-4830,-4829,-4828,-4827,-4827,-4827,-4827,-4827,-4828,-4828,-4829,-4829,-4830,-4831,-4831,-4832,-4832,-4832,-4833,-4833},
{-6298,-6170,-6052,-5942,-5841,-5747,-5660,-5579,-5505,-5436,-5372,-5314,-5259,-5209,-5163,-5120,-5081,-5045,-5012,-4981,-4953,-4928,-4905,-4883,-4864,-4847,-4831,-4817,-4804,-4793,-4783,-4774,-4766,-4759,-4753,-4748,-4743,-4739,-4736,-4734,-4732,-4730,-4729,-4728,-4727,-4727,-4727,-4727,-4727,-4728,-4728,-4728,-4729,-4729,-4730,-4730,-4730,-4731,-4731,-4731},
{-6161,-6037,-5922,-5815,-5717,-5625,-5541,-5463,-5390,-5323,-5261,-5204,-5151,-5102,-5056,-5015,-4976,-4941,-4908,-4878,-4851,-4826,-4803,-4782,-4763,-4746,-4731,-4717,-4704,-4693,-4683,-4674,-4666,-4659,-4653,-4648,-4643,-4639,-4636,-4633,-4631,-4629,-4628,-4627,-4626,-4626,-4626,-4626,-4626,-4626,-4626,-4626,-4627,-4627,-4627,-4628,-4628,-4628,-4628,-4628},
{-6020,-5900,-5789,-5686,-5590,-5501,-5419,-5343,-5272,-5207,-5147,-5091,-5039,-4991,-4947,-4906,-4869,-4834,-4802,-4773,-4746,-4722,-4699,-4679,-4660,-4644,-4628,-4614,-4602,-4591,-4581,-4572,-4564,-4557,-4551,-4546,-4541,-4538,-4534,-4532,-4529,-4527,-4526,-4525,-4524,-4524,-4523,-4523,-4523,-4523,-4523,-4523,-4524,-4524,-4524,-4524,-4524,-4524,-4524,-4524},
{-5877,-5761,-5653,-5553,-5460,-5374,-5294,-5220,-5152,-5088,-5030,-4975,-4925,-4878,-4835,-4795,-4759,-4725,-4694,-4666,-4639,-4616,-4594,-4574,-4555,-4539,-4524,-4510,-4498,-4487,-4477,-4469,-4461,-4454,-4448,-4443,-4438,-4435,-4431,-4429,-4426,-4424,-4423,-4422,-4421,-4420,-4420,-4420,-4419,-4419,-4419,-4419,-4420,-4420,-4420,-4420,-4420,-4420,-4420,-4420},
{-5732,-5620,-5515,-5418,-5328,-5245,-5167,-5095,-5029,-4967,-4910,-4857,-4808,-4763,-4721,-4683,-4647,-4614,-4584,-4556,-4531,-4507,-4486,-4466,-4449,-4433,-4418,-4405,-4393,-4382,-4373,-4364,-4356,-4350,-4344,-4339,-4334,-4331,-4327,-4325,-4322,-4320,-4319,-4318,-4317,-4316,-4316,-4315,-4315,-4315,-4315,-4315,-4315,-4315,-4315,-4315,-4315,-4315,-4315,-4315},
{-5585,-5476,-5375,-5281,-5194,-5113,-5038,-4968,-4904,-4844,-4788,-4737,-4690,-4646,-4605,-4568,-4533,-4501,-4472,-4445,-4420,-4397,-4377,-4358,-4341,-4325,-4311,-4298,-4286,-4276,-4267,-4258,-4251,-4244,-4239,-4234,-4229,-4226,-4223,-4220,-4218,-4216,-4214,-4213,-4212,-4211,-4211,-4211,-4210,-4210,-4210,-4210,-4210,-4210,-4210,-4210,-4210,-4210,-4210,-4210},
{-5436,-5330,-5232,-5142,-5057,-4979,-4906,-4839,-4777,-4719,-4665,-4615,-4569,-4527,-4487,-4451,-4418,-4387,-4358,-4332,-4308,-4286,-4266,-4248,-4231,-4216,-4202,-4190,-4179,-4169,-4160,-4152,-4145,-4138,-4133,-4128,-4124,-4120,-4117,-4115,-4112,-4111,-4109,-4108,-4107,-4106,-4106,-4106,-4105,-4105,-4105,-4105,-4105,-4105,-4105,-4105,-4105,-4105,-4105,-4105},
{-5285,-5183,-5088,-5001,-4919,-4844,-4773,-4708,-4648,-4592,-4540,-4492,-4447,-4406,-4368,-4333,-4301,-4271,-4243,-4218,-4195,-4174,-4155,-4137,-4121,-4106,-4093,-4081,-4070,-4061,-4052,-4044,-4038,-4031,-4026,-4022,-4018,-4014,-4011,-4009,-4007,-4005,-4004,-4003,-4002,-4001,-4001,-4000,-4000,-4000,-4000,-4000,-4000,-4000,-4000,-4000,-4000,-4000,-4000,-4000},
{-5133,-5034,-4943,-4858,-4780,-4707,-4639,-4576,-4518,-4464,-4414,-4367,-4324,-4285,-4248,-4214,-4183,-4154,-4128,-4103,-4081,-4061,-4042,-4025,-4010,-3996,-3996,-3972,-3961,-3952,-3944,-3937,-3930,-3925,-3920,-3915,-3911,-3908,-3906,-3903,-3901,-3900,-3898,-3897,-3897,-3896,-3895,-3895,-3895,-3895,-3895,-3895,-3895,-3895,-3895,-3895,-3895,-3895,-3895,-3895},
{-4979,-4884,-4796,-4715,-4639,-4569,-4503,-4443,-4386,-4334,-4334,-4241,-4200,-4162,-4127,-4094,-4064,-4036,-4011,-3988,-3966,-3947,-3929,-3913,-3898,-3885,-3873,-3862,-3852,-3843,-3836,-3829,-3823,-3817,-3813,-3809,-3805,-3802,-3800,-3797,-3796,-3794,-3793,-3792,-3791,-3791,-3790,-3790,-3790,-3790,-3790,-3790,-3790,-3790,-3790,-3790,-3790,-3790,-3790,-3790},
{-4825,-4734,-4649,-4570,-4497,-4429,-4367,-4308,-4254,-4204,-4158,-4115,-4075,-4038,-4005,-3973,-3945,-3918,-3894,-3872,-3851,-3833,-3816,-3800,-3786,-3774,-3762,-3752,-3743,-3735,-3727,-3721,-3715,-3710,-3706,-3702,-3699,-3696,-3694,-3692,-3690,-3689,-3688,-3687,-3687,-3686,-3686,-3685,-3685,-3685,-3685,-3685,-3685,-3685,-3685,-3685,-3685,-3685,-3685,-3685},
{-4670,-4582,-4501,-4425,-4355,-4290,-4229,-4173,-4121,-4073,-4029,-3988,-3950,-3915,-3882,-3852,-3825,-3800,-3777,-3755,-3736,-3718,-3702,-3688,-3674,-3663,-3652,-3642,-3634,-3626,-3619,-3613,-3608,-3603,-3599,-3596,-3593,-3590,-3588,-3587,-3585,-3584,-3583,-3583,-3582,-3582,-3582,-3581,-3581,-3581,-3581,-3581,-3581,-3581,-3581,-3581,-3581,-3581,-3581,-3581},
{-4514,-4430,-4352,-4279,-4212,-4149,-4091,-4038,-3988,-3942,-3900,-3860,-3824,-3790,-3760,-3731,-3705,-3681,-3659,-3639,-3621,-3604,-3589,-3575,-3563,-3551,-3541,-3532,-3524,-3517,-3511,-3506,-3501,-3497,-3493,-3490,-3487,-3485,-3484,-3482,-3481,-3480,-3479,-3479,-3478,-3478,-3478,-3478,-3478,-3478,-3478,-3478,-3478,-3478,-3478,-3478,-3478,-3478,-3478,-3478},
{-4359,-4278,-4203,-4133,-4069,-4009,-3953,-3902,-3855,-3811,-3770,-3732,-3698,-3666,-3637,-3610,-3585,-3562,-3542,-3523,-3505,-3490,-3476,-3463,-3451,-3441,-3432,-3423,-3416,-3409,-3404,-3399,-3394,-3391,-3388,-3385,-3383,-3381,-3379,-3378,-3377,-3376,-3376,-3376,-3375,-3375,-3375,-3375,-3375,-3375,-3375,-3375,-3375,-3375,-3375,-3375,-3375,-3375,-3375,-3375},
{-4203,-4125,-4053,-3987,-3925,-3868,-3815,-3766,-3721,-3679,-3641,-3605,-3572,-3542,-3514,-3489,-3465,-3444,-3424,-3407,-3391,-3376,-3363,-3351,-3340,-3331,-3322,-3315,-3308,-3302,-3297,-3293,-3289,-3285,-3283,-3280,-3279,-3277,-3276,-3275,-3274,-3274,-3273,-3273,-3273,-3273,-3273,-3273,-3273,-3273,-3273,-3273,-3273,-3273,-3273,-3273,-3273,-3273,-3273,-3273}};
    
    int16 J2_2[61][60] = {{-841,-1327,-1646,-1831,-1916,-1929,-1892,-1820,-1725,-1616,-1499,-1378,-1257,-1137,-1021,-909,-801,-700,-604,-514,-430,-352,-280,-214,-153,-99,-49,-6,33,67,95,119,138,153,163,169,170,168,161,151,136,118,96,71,41,9,-27,-66,-109,-155,-203,-255,-311,-369,-430,-493,-560,-629,-702,-776},
{-344,-701,-967,-1145,-1250,-1297,-1301,-1272,-1221,-1153,-1075,-990,-902,-813,-724,-638,-554,-473,-396,-324,-256,-192,-133,-79,-30,15,55,91,122,148,171,189,203,213,219,220,219,213,203,190,174,154,130,103,73,39,2,-37,-80,-127,-176,-228,-283,-340,-401,-464,-530,-599,-670,-744},
{-125,-361,-558,-704,-800,-854,-873,-866,-838,-795,-742,-681,-616,-548,-479,-411,-344,-279,-217,-158,-102,-50,-2,43,84,120,153,182,207,228,245,258,268,274,276,275,270,262,250,235,217,195,170,142,111,77,39,-1,-45,-91,-140,-192,-247,-304,-364,-427,-492,-560,-631,-704},
{-38,-176,-307,-413,-489,-536,-558,-558,-542,-514,-475,-430,-380,-327,-272,-217,-163,-110,-59,-10,36,79,119,156,190,220,247,270,290,307,320,329,335,338,337,334,326,316,302,286,266,243,217,188,156,121,83,42,-1,-48,-97,-149,-203,-260,-320,-382,-447,-514,-584,-656},
{-8,-71,-146,-214,-266,-301,-318,-319,-308,-286,-256,-220,-180,-137,-93,-48,-3,41,83,124,163,199,233,264,292,317,339,358,373,386,395,402,405,405,402,396,387,375,360,341,320,296,269,240,207,171,133,92,49,2,-47,-98,-153,-209,-269,-330,-395,-461,-530,-602},
{5,-2,-33,-68,-98,-118,-127,-126,-115,-96,-71,-41,-7,28,66,104,142,179,215,250,282,313,342,368,391,412,430,445,457,467,474,477,478,476,471,463,452,439,422,403,381,356,328,298,264,229,190,149,105,59,10,-41,-95,-152,-211,-272,-335,-401,-470,-540},
{20,53,56,48,38,31,31,37,50,68,91,118,147,178,211,244,276,308,340,369,397,424,448,470,490,507,522,534,543,550,554,556,555,551,544,534,522,507,490,469,446,421,392,361,328,292,253,212,168,122,73,22,-32,-88,-146,-207,-270,-336,-403,-473},
{47,109,137,150,156,162,170,181,197,216,238,263,289,317,346,375,404,432,459,485,510,533,553,572,589,603,615,625,632,636,638,638,635,629,621,610,597,581,562,541,517,491,462,431,397,361,322,280,237,190,142,91,37,-19,-77,-137,-200,-264,-331,-401},
{91,171,218,247,267,282,298,314,332,352,375,399,424,449,476,502,528,553,577,600,621,641,659,675,689,701,711,718,723,726,726,724,719,712,703,691,676,659,640,618,594,567,537,506,471,435,396,354,310,264,216,165,112,56,-2,-62,-124,-188,-255,-323},
{152,244,304,345,375,399,420,441,462,483,506,529,553,578,602,626,649,672,694,714,733,750,766,779,791,801,809,814,817,818,817,813,808,799,789,776,760,742,722,699,674,647,617,585,551,514,474,433,389,343,294,244,191,135,78,18,-43,-107,-173,-241},
{229,329,398,447,484,515,541,565,588,611,634,658,681,704,727,749,770,791,810,829,845,861,874,886,896,904,909,913,915,914,912,907,900,890,878,864,848,829,808,785,760,732,702,669,634,597,558,516,472,426,378,327,274,219,162,162,41,-22,-88,-156},
{323,426,500,555,598,633,663,689,715,739,762,785,808,830,851,872,892,911,928,945,959,973,984,994,1002,1009,1013,1015,1016,1014,1010,1004,995,985,972,957,940,921,899,875,849,821,790,757,722,685,645,603,559,513,465,414,361,307,250,191,129,66,1,-66},
{430,534,611,670,716,754,787,816,842,867,891,913,935,956,977,996,1015,1032,1048,1062,1076,1087,1097,1106,1112,1117,1120,1120,1119,1116,1111,1104,1094,1083,1069,1053,1036,1015,993,969,942,913,882,849,813,776,736,694,650,604,555,505,452,397,341,282,221,158,93,26},
{550,653,731,791,840,880,914,945,972,997,1021,1043,1064,1084,1104,1122,1139,1155,1169,1182,1194,1204,1212,1219,1224,1227,1229,1228,1226,1222,1215,1207,1197,1184,1170,1153,1134,1113,1091,1065,1038,1009,977,944,908,870,830,788,744,697,649,598,546,491,434,376,315,252,188,121},
{680,781,859,920,970,1011,1046,1077,1104,1129,1153,1175,1195,1214,1232,1249,1265,1279,1292,1304,1314,1323,1330,1335,1339,1341,1341,1339,1335,1330,1322,1313,1302,1288,1273,1256,1236,1214,1191,1165,1137,1108,1076,1042,1005,967,927,885,840,794,745,694,642,587,531,472,411,349,284,218},
{821,918,994,1055,1104,1146,1181,1212,1239,1264,1287,1308,1328,1346,1363,1379,1393,1406,1417,1428,1436,1444,1449,1453,1456,1456,1455,1452,1447,1441,1432,1422,1409,1395,1379,1361,1340,1318,1294,1267,1239,1209,1176,1142,1105,1067,1026,984,939,892,844,793,740,685,629,570,510,447,383,317},
{969,1062,1136,1195,1244,1285,1320,1351,1378,1402,1424,1444,1463,1480,1495,1510,1523,1534,1545,1553,1561,1566,1571,1573,1574,1574,1571,1567,1561,1554,1544,1533,1519,1504,1487,1468,1447,1424,1399,1372,1343,1312,1279,1244,1207,1168,1127,1085,1040,993,944,893,840,785,729,670,610,547,483,417},
{1125,1213,1284,1341,1389,1429,1463,1493,1519,1542,1563,1582,1600,1616,1630,1643,1655,1665,1674,1681,1687,1691,1694,1696,1695,1693,1690,1684,1677,1668,1658,1645,1631,1615,1597,1577,1555,1531,1506,1478,1449,1417,1384,1348,1311,1272,1230,1187,1142,1095,1045,994,941,887,830,771,711,648,584,518},
{1286,1369,1437,1492,1538,1576,1609,1637,1662,1685,1705,1722,1739,1753,1766,1778,1788,1797,1804,1810,1815,1818,1819,1819,1818,1814,1810,1803,1795,1785,1773,1760,1744,1727,1708,1688,1665,1641,1614,1586,1556,1524,1490,1454,1416,1376,1334,1291,1245,1198,1148,1097,1044,989,932,873,812,750,686,620},
{1452,1530,1594,1646,1690,1726,1758,1785,1808,1829,1848,1864,1879,1892,1904,1914,1923,1930,1936,1941,1944,1945,1946,1944,1941,1937,1931,1923,1914,1903,1890,1875,1859,1841,1821,1800,1776,1751,1724,1695,1664,1631,1596,1560,1521,1481,1439,1395,1349,1301,1251,1200,1147,1091,1034,975,915,852,788,722},
{1622,1695,1755,1804,1845,1880,1909,1934,1956,1976,1993,2008,2021,2033,2043,2052,2059,2065,2069,2072,2074,2074,2073,2070,2066,2060,2053,2044,2033,2021,2007,1992,1974,1955,1935,1912,1888,1862,1834,1804,1772,1739,1704,1667,1628,1587,1544,1500,1453,1405,1355,1303,1249,1194,1137,1078,1017,954,890,824},
{1795,1863,1919,1965,2003,2035,2062,2086,2106,2124,2139,2153,2164,2174,2183,2190,2196,2200,2203,2205,2205,2204,2201,2197,2191,2184,2176,2166,2154,2140,2125,2109,2090,2070,2049,2025,2000,1973,1944,1914,1881,1847,1811,1774,1734,1693,1649,1604,1558,1509,1459,1406,1352,1297,1239,1180,1119,1056,992,925},
{1971,2034,2085,2127,2163,2192,2217,2239,2257,2273,2287,2298,2308,2317,2324,2329,2333,2336,2338,2338,2336,2334,2330,2324,2317,2309,2299,2287,2274,2260,2244,2226,2207,2186,2163,2138,2112,2084,2055,2023,1990,1956,1919,1880,1840,1798,1755,1709,1662,1613,1562,1509,1455,1399,1341,1281,1220,1157,1092,1026},
{2148,2206,2253,2291,2324,2351,2373,2393,2409,2423,2435,2445,2453,2459,2465,2469,2471,2472,2472,2471,2468,2464,2458,2451,2443,2433,2422,2409,2395,2379,2362,2343,2323,2301,2277,2251,2224,2196,2165,2133,2099,2063,2026,1987,1946,1903,1859,1813,1765,1715,1664,1611,1556,1500,1442,1382,1320,1257,1192,1126},
{2327,2379,2421,2457,2486,2510,2530,2547,2561,2573,2583,2591,2597,2602,2606,2608,2609,2608,2607,2604,2599,2594,2587,2578,2569,2557,2545,2531,2515,2498,2480,2460,2438,2415,2390,2364,2336,2306,2275,2242,2207,2170,2132,2092,2051,2008,1963,1916,1867,1817,1765,1712,1657,1600,1541,1481,1419,1356,1291,1224},
{2505,2552,2591,2622,2648,2670,2687,2702,2714,2724,2731,2738,2742,2745,2747,2747,2746,2744,2741,2736,2730,2723,2714,2705,2693,2681,2667,2652,2635,2617,2597,2576,2553,2529,2503,2475,2446,2416,2383,2349,2314,2276,2238,2197,2155,2111,2065,2017,1969,1918,1866,1811,1756,1699,1640,1579,1517,1453,1388,1321},
{2684,2726,2761,2788,2811,2830,2845,2857,2866,2874,2879,2884,2886,2887,2887,2886,2883,2879,2874,2868,2860,2852,2842,2830,2818,2804,2788,2772,2754,2734,2713,2691,2667,2641,2614,2586,2556,2524,2491,2456,2419,2381,2341,2300,2257,2212,2166,2118,2068,2017,1964,1909,1853,1795,1736,1675,1613,1549,1483,1416},
{2863,2900,2930,2954,2973,2989,3001,3011,3018,3023,3027,3029,3029,3029,3027,3023,3019,3013,3006,2999,2989,2979,2967,2955,2941,2925,2908,2890,2871,2850,2828,2804,2779,2753,2724,2695,2664,2631,2597,2561,2523,2484,2444,2401,2358,2312,2265,2216,2166,2114,2061,2005,1949,1890,1831,1769,1707,1642,1576,1509},
{3040,3072,3098,3119,3135,3147,3157,3164,3169,3172,3173,3173,3172,3169,3165,3160,3153,3146,3138,3128,3117,3105,3092,3078,3062,3045,3027,3008,2987,2965,2941,2916,2890,2862,2833,2802,2770,2736,2701,2664,2625,2586,2544,2501,2456,2410,2362,2313,2262,2209,2155,2099,2042,1983,1923,1861,1798,1733,1667,1600},
{3216,3244,3266,3282,3295,3305,3312,3316,3318,3319,3318,3316,3312,3308,3302,3295,3287,3277,3267,3256,3243,3230,3215,3199,3182,3163,3144,3123,3101,3077,3053,3026,2999,2970,2939,2907,2874,2839,2803,2765,2726,2685,2642,2598,2553,2506,2457,2407,2355,2302,2247,2191,2133,2074,2013,1951,1887,1822,1756,1688},
{3391,3414,3431,3445,3454,3461,3465,3466,3466,3465,3462,3457,3451,3445,3437,3428,3418,3407,3395,3382,3367,3352,3336,3318,3300,3280,3259,3236,3213,3188,3162,3134,3105,3075,3043,3010,2976,2940,2902,2864,2823,2781,2738,2693,2647,2599,2549,2498,2446,2392,2337,2280,2221,2161,2100,2037,1973,1908,1841,1773},
{3563,3582,3595,3605,3611,3615,3616,3615,3612,3608,3603,3596,3589,3580,3570,3559,3547,3534,3520,3506,3490,3473,3455,3435,3415,3394,3371,3347,3322,3296,3269,3240,3210,3178,3145,3111,3075,3038,3000,2960,2918,2875,2831,2785,2738,2689,2639,2587,2534,2479,2423,2366,2307,2246,2185,2121,2057,1991,1924,1855},
{3733,3747,3757,3763,3766,3767,3765,3762,3757,3750,3742,3733,3723,3713,3701,3688,3674,3659,3644,3627,3609,3591,3571,3550,3528,3505,3481,3456,3430,3402,3373,3343,3311,3278,3244,3209,3172,3134,3094,3053,3011,2967,2921,2875,2826,2777,2726,2673,2619,2564,2507,2449,2389,2328,2266,2202,2137,2071,2004,1935},
{3901,3911,3917,3919,3919,3916,3912,3906,3898,3889,3879,3868,3856,3843,3829,3814,3799,3782,3764,3746,3726,3706,3685,3662,3639,3614,3589,3562,3534,3505,3474,3443,3410,3376,3340,3304,3266,3226,3186,3143,3100,3055,3009,2961,2912,2861,2809,2756,2701,2645,2587,2529,2468,2407,2344,2280,2214,2148,2080,2011},
{4065,4071,4073,4072,4069,4063,4056,4047,4037,4026,4013,4000,3986,3971,3955,3938,3920,3902,3882,3862,3841,3819,3796,3771,3746,3720,3693,3665,3635,3605,3573,3540,3506,3470,3434,3396,3356,3316,3274,3231,3186,3140,3093,3044,2994,2942,2889,2835,2780,2723,2665,2605,2544,2482,2419,2354,2288,2221,2153,2084},
{4227,4229,4227,4223,4216,4208,4197,4186,4173,4159,4145,4129,4113,4095,4077,4059,4039,4018,3997,3975,3952,3928,3903,3877,3851,3823,3794,3764,3733,3701,3668,3634,3598,3561,3523,3484,3444,3402,3359,3314,3269,3221,3173,3123,3072,3020,2966,2911,2855,2797,2738,2678,2617,2554,2490,2425,2358,2291,2222,2153},
{4385,4383,4377,4370,4360,4348,4336,4321,4306,4290,4273,4255,4236,4217,4197,4176,4154,4132,4109,4085,4060,4034,4008,3980,3952,3923,3892,3861,3828,3795,3760,3724,3687,3649,3610,3569,3527,3484,3440,3395,3348,3299,3250,3199,3147,3094,3039,2984,2926,2868,2808,2747,2685,2622,2557,2492,2425,2357,2288,2218},
{4539,4533,4524,4513,4501,4486,4470,4454,4436,4417,4398,4378,4357,4335,4313,4290,4266,4242,4217,4191,4165,4137,4109,4080,4050,4019,3987,3954,3920,3884,3848,3811,3773,3733,3693,3651,3608,3563,3518,3471,3423,3374,3323,3272,3219,3164,3109,3052,2994,2935,2875,2813,2750,2686,2621,2555,2488,2420,2350,2280},
{4690,4680,4668,4653,4638,4620,4602,4582,4562,4541,4519,4497,4474,4450,4426,4401,4375,4349,4322,4294,4266,4236,4206,4175,4144,4111,4077,4043,4007,3971,3933,3894,3855,3814,3772,3728,3684,3639,3592,3544,3495,3444,3393,3340,3286,3231,3174,3117,3058,2998,2937,2875,2811,2747,2681,2615,2547,2478,2409,2338},
{4837,4823,4807,4790,4771,4751,4729,4707,4685,4661,4637,4612,4587,4561,4535,4508,4480,4452,4423,4393,4363,4332,4300,4267,4234,4200,4164,4128,4091,4053,4014,3974,3932,3890,3847,3802,3757,3710,3662,3613,3562,3511,3458,3404,3349,3293,3236,3177,3118,3057,2995,2932,2868,2803,2737,2670,2602,2533,2463,2392},
{4980,4962,4943,4922,4900,4877,4853,4828,4803,4777,4751,4724,4696,4668,4640,4611,4581,4551,4520,4488,4456,4423,4390,4355,4320,4284,4247,4210,4171,4131,4090,4049,4006,3963,3918,3872,3825,3777,3728,3677,3626,3573,3520,3465,3409,3352,3294,3234,3174,3112,3050,2986,2921,2856,2789,2722,2653,2584,2513,2442},
{5118,5097,5074,5050,5025,5000,4973,4946,4918,4889,4861,4831,4802,4771,4741,4710,4678,4646,4613,4580,4546,4511,4475,4439,4402,4365,4326,4287,4247,4205,4163,4120,4076,4031,3985,3937,3889,3840,3789,3738,3685,3632,3577,3521,3464,3406,3347,3287,3225,3163,3100,3036,2970,2904,2837,2769,2700,2630,2560,2488},
{5252,5227,5202,5174,5147,5118,5088,5059,5028,4997,4966,4935,4903,4870,4838,4804,4771,4737,4702,4667,4631,4594,4557,4519,4481,4441,4401,4360,4318,4275,4232,4187,4141,4095,4047,3999,3949,3899,3847,3794,3741,3686,3630,3573,3515,3456,3396,3335,3273,3210,3146,3081,3015,2948,2881,2812,2743,2673,2602,2530},
{5381,5353,5324,5294,5263,5232,5200,5167,5134,5101,5068,5034,5000,4965,4930,4895,4859,4823,4787,4749,4712,4673,4634,4595,4554,4513,4471,4429,4385,4341,4296,4250,4203,4155,4106,4056,4005,3953,3900,3846,3791,3736,3679,3621,3562,3502,3441,3379,3316,3252,3188,3122,3056,2988,2920,2851,2782,2711,2640,2569},
{5506,5475,5442,5409,5376,5341,5307,5272,5236,5201,5165,5129,5092,5056,5019,4981,4944,4906,4867,4828,4788,4748,4707,4666,4624,4581,4538,4493,4448,4402,4356,4308,4259,4210,4160,4109,4056,4003,3949,3894,3838,3781,3723,3664,3604,3543,3481,3419,3355,3290,3225,3159,3092,3024,2956,2886,2816,2746,2674,2602},
{5626,5592,5556,5520,5483,5446,5409,5371,5334,5296,5258,5219,5181,5142,5103,5063,5024,4983,4943,4902,4860,4818,4776,4733,4689,4644,4599,4553,4507,4459,4411,4362,4312,4261,4209,4157,4103,4049,3993,3937,3880,3822,3763,3703,3642,3580,3518,3454,3390,3324,3258,3192,3124,3056,2987,2917,2847,2776,2704,2632},
{5741,5703,5665,5626,5586,5547,5507,5467,5426,5386,5346,5305,5264,5223,5182,5141,5099,5057,5014,4971,4928,4884,4840,4795,4749,4703,4656,4609,4561,4512,4462,4411,4360,4308,4254,4200,4146,4090,4033,3976,3918,3858,3798,3737,3676,3613,3549,3485,3420,3354,3287,3220,3152,3083,3014,2944,2873,2802,2730,2658},
{5852,5811,5769,5727,5685,5642,5600,5557,5515,5472,5429,5386,5343,5300,5257,5213,5170,5126,5081,5036,4991,4946,4899,4853,4805,4757,4709,4660,4610,4559,4508,4456,4403,4349,4295,4240,4184,4127,4069,4010,3951,3890,3829,3767,3705,3641,3577,3512,3446,3379,3312,3244,3175,3106,3036,2966,2895,2824,2752,2680},
{5957,5913,5868,5823,5778,5733,5688,5643,5598,5553,5508,5463,5418,5373,5327,5282,5236,5190,5143,5097,5050,5002,4954,4906,4857,4807,4757,4706,4655,4603,4550,4496,4442,4387,4331,4274,4217,4159,4100,4040,3979,3918,3856,3793,3729,3665,3600,3534,3467,3400,3332,3264,3195,3125,3055,2984,2913,2842,2770,2698},
{6057,6010,5962,5915,5867,5819,5772,5724,5677,5629,5582,5535,5488,5440,5393,5345,5297,5249,5201,5152,5104,5054,5004,4954,4903,4852,4800,4748,4695,4641,4587,4532,4476,4420,4363,4305,4246,4187,4126,4065,4004,3941,3878,3814,3750,3684,3618,3552,3485,3417,3348,3279,3210,3140,3069,2998,2927,2856,2784,2711},
{6153,6102,6052,6001,5951,5900,5850,5800,5751,5701,5651,5602,5553,5503,5453,5404,5354,5304,5254,5203,5153,5102,5050,4998,4946,4893,4839,4785,4731,4675,4620,4563,4506,4448,4389,4330,4270,4210,4148,4086,4023,3960,3896,3831,3766,3700,3633,3565,3498,3429,3360,3291,3221,3150,3080,3009,2937,2865,2793,2721},
{6243,6189,6136,6083,6029,5977,5924,5872,5820,5768,5716,5664,5613,5561,5510,5458,5406,5354,5302,5250,5197,5144,5091,5037,4983,4928,4873,4818,4762,4705,4647,4590,4531,4472,4412,4351,4290,4228,4166,4103,4039,3974,3909,3843,3777,3710,3643,3575,3506,3437,3368,3298,3228,3157,3086,3015,2943,2871,2799,2727},
{6328,6271,6215,6159,6103,6048,5993,5938,5884,5830,5776,5722,5668,5614,5561,5507,5453,5400,5346,5291,5237,5182,5127,5072,5016,4960,4903,4846,4788,4730,4671,4612,4552,4491,4430,4368,4306,4243,4179,4115,4050,3984,3918,3852,3784,3717,3649,3580,3511,3441,3371,3301,3230,3159,3088,3017,2945,2873,2801,2729},
{6407,6348,6289,6230,6172,6114,6057,6000,5943,5887,5831,5775,5719,5663,5607,5552,5496,5440,5384,5328,5272,5216,5159,5102,5044,4986,4928,4869,4810,4750,4690,4629,4568,4506,4443,4380,4317,4252,4188,4122,4056,3990,3923,3856,3788,3719,3650,3581,3511,3441,3371,3300,3229,3158,3087,3015,2943,2871,2800,2728},
{6482,6420,6358,6297,6236,6176,6116,6057,5998,5939,5881,5822,5765,5707,5649,5592,5534,5476,5419,5361,5303,5244,5186,5127,5068,5008,5008,4888,4827,4766,4704,4642,4579,4516,4452,4388,4323,4258,4192,4126,4059,3991,3923,3855,3786,3717,3648,3578,3508,3437,3366,3295,3224,3153,3081,3009,2938,2866,2794,2722},
{6552,6487,6422,6358,6295,6232,6170,6108,6047,5986,5986,5866,5806,5746,5686,5627,5567,5508,5448,5388,5328,5268,5208,5148,5087,5026,4964,4902,4840,4777,4714,4650,4586,4522,4457,4391,4325,4259,4192,4125,4057,3988,3920,3851,3781,3711,3641,3571,3500,3429,3358,3287,3215,3143,3072,3000,2928,2857,2785,2714},
{6616,6548,6481,6415,6349,6284,6219,6155,6092,6029,5966,5904,5842,5780,5718,5657,5596,5534,5473,5411,5350,5288,5226,5164,5101,5038,4975,4912,4848,4784,4719,4655,4589,4523,4457,4390,4323,4256,4188,4119,4051,3981,3912,3842,3772,3701,3631,3560,3489,3417,3346,3274,3202,3131,3059,2987,2915,2844,2772,2701},
{6675,6605,6535,6466,6398,6331,6264,6198,6132,6067,6002,5938,5873,5810,5746,5683,5619,5556,5493,5430,5366,5303,5239,5175,5111,5047,4982,4917,4852,4787,4721,4654,4588,4521,4453,4385,4317,4248,4179,4110,4040,3970,3900,3830,3759,3688,3616,3545,3473,3401,3330,3258,3186,3114,3042,2971,2899,2828,2756,2685},
{6729,6656,6584,6513,6442,6372,6303,6235,6167,6100,6033,5966,5900,5835,5769,5704,5639,5574,5509,5443,5378,5313,5248,5182,5117,5051,4985,4918,4852,4785,4717,4650,4582,4514,4445,4376,4307,4237,4167,4097,4026,3955,3884,3813,3742,3670,3598,3526,3454,3382,3310,3238,3166,3094,3022,2950,2879,2808,2737,2666},
{6779,6703,6628,6554,6482,6409,6338,6267,6197,6128,6059,5991,5923,5855,5788,5720,5653,5586,5520,5453,5386,5319,5252,5185,5118,5051,4983,4915,4847,4779,4710,4641,4572,4502,4433,4363,4292,4222,4151,4080,4008,3936,3865,3793,3721,3648,3576,3504,3431,3359,3287,3215,3142,3070,2999,2927,2856,2785,2714,2644},
{6823,6745,6667,6591,6516,6442,6368,6295,6223,6152,6081,6010,5940,5871,5801,5732,5664,5595,5526,5458,5389,5321,5252,5184,5115,5046,4977,4908,4838,4769,4699,4628,4558,4487,4416,4345,4274,4202,4130,4058,3986,3914,3841,3769,3696,3623,3551,3478,3405,3333,3260,3188,3116,3044,2972,2900,2829,2759,2688,2618}};
    
    
   
    int desForce12X; //desired force in X direction
    int desForce12Y; //desired force in Y direction
    int desForce34X; //desired force in X direction
    int desForce34Y; //desired force in Y direction
    int desForce56X; //desired force in X direction
    int desForce56Y; //desired force in Y direction
    int desForce78X; //desired force in X direction
    int desForce78Y; //desired force in Y direction

    //Controller Parameters


    int state = 0;

    
    int motor1start = -Counter_1_ReadCounter();// initialize position
    int motor2start = Counter_2_ReadCounter();
    int motor3start = -Counter_3_ReadCounter();
    int motor4start = Counter_4_ReadCounter();
    int motor5start = Counter_5_ReadCounter();// initialize position
    int motor6start = -Counter_6_ReadCounter();
    int motor7start = Counter_7_ReadCounter();
    int motor8start = -Counter_8_ReadCounter();

    motor1pos_current = motor1start;
    motor2pos_current = motor2start;
    motor3pos_current = motor3start;
    motor4pos_current = motor4start;
    motor5pos_current = motor5start;
    motor6pos_current = motor6start;
    motor7pos_current = motor7start;
    motor8pos_current = motor8start;
    
    motor1pos_previous = motor1start;
    motor2pos_previous = motor2start;
    motor3pos_previous = motor3start;
    motor4pos_previous = motor4start;
    motor5pos_previous = motor5start;
    motor6pos_previous = motor6start;
    motor7pos_previous = motor7start;
    motor8pos_previous = motor8start;

    Enable_1_Write(0);
    Enable_2_Write(0);
    Enable_3_Write(0);
    Enable_4_Write(0);
    Enable_5_Write(0);
    Enable_6_Write(0);
    Enable_7_Write(0);
    Enable_8_Write(0);
    
    CyDelay(5000);
    int stateCountA = 0;
    int stateCountB = 0;
    int stateCount = 0;
    int c = 1;

    
    cmdVal1 = 0;
    cmdVal2 = 0;
    cmdVal3 = 0;
    cmdVal4 = 0;
    cmdVal5 = 0;
    cmdVal6 = 0;
    cmdVal7 = 0;
    cmdVal8 = 0;
    
    Enable_1_Write(1);
    Enable_2_Write(1);
    Enable_3_Write(1);
    Enable_4_Write(1);
    Enable_5_Write(1);
    Enable_6_Write(1);
    Enable_7_Write(1);
    Enable_8_Write(1);
 
    int stateA = 1;
    int stateB = 1;
    int minn = 2000; 
    int maxx = 10000;
    //LED1_Write(1);
    //LED2_Write(1);
    //LED5_Write(1);
    
    int stateHop = 1;
    int state1256 = 4;
    int state3478 = 4;
    int jumps1256 = 0;
    int jumps3478 = 0;
    int stateCount1256 = 0;
    int stateCount3478 = 0;
    while(Estop == 0)
    {
        pinA_Write(1);
        pinA_Write(0);
        global_time = (global_time_loops*Timer_3_ReadPeriod()) + Timer_3_ReadCounter();
        //Toggle pin for speed measuring purposes
        loop_iter++;
        //GetIMUdata();
        
        //LED2_Write(1);
        //LED1_Write(1);
        //LED3_Write(1);
        //LED4_Write(1);
        //LED5_Write(1);
        
        motor1pos_current = -Counter_1_ReadCounter() - motor1start;
        motor2pos_current = Counter_2_ReadCounter() - motor2start;
        motor3pos_current = -Counter_3_ReadCounter() - motor3start;
        motor4pos_current = Counter_4_ReadCounter() - motor4start;
        motor5pos_current = Counter_5_ReadCounter() - motor5start;
        motor6pos_current = -Counter_6_ReadCounter() - motor6start;
        motor7pos_current = Counter_7_ReadCounter() - motor7start;
        motor8pos_current = -Counter_8_ReadCounter() - motor8start;
            
        angle1 = motor1pos_current*(45.0/5888.0)+90.0;
        angle2 = motor2pos_current*(45.0/5888.0)+90.0;
        angle3 = motor3pos_current*(45.0/5888.0)+90.0;
        angle4 = motor4pos_current*(45.0/5888.0)+90.0;
        angle5 = motor5pos_current*(45.0/5888.0)+90.0;
        angle6 = motor6pos_current*(45.0/5888.0)+90.0;
        angle7 = motor7pos_current*(45.0/5888.0)+90.0;
        angle8 = motor8pos_current*(45.0/5888.0)+90.0;
        
//    stateCountA = stateCountA + 1;
//    if (stateCountA>14000)
//    {stateCountA = 0;}
//    
//    
//    stateCountB = stateCountB + 1;
//    if (stateCountB>14000)
//    {stateCountB = 0;}
//    
//    
    

//    
//    if (stateCount>5000)
//        doo = 0;
//    else
//        doo = 1;
     
        int doo = 1;
//        state3478 = 100;
//        cmdVal3 = (00 - 2000*doo - motor3pos_current)*.2 - velMeasured3*0.01;
//        cmdVal4 = (00 - 2000*doo - motor4pos_current)*.2 - velMeasured4*0.01;
//    
//        cmdVal7 = (00 - 2000*doo - motor7pos_current)*.2 - velMeasured7*0.01;
//        cmdVal8 = (00 - 2000*doo - motor8pos_current)*.2 - velMeasured8*0.01;
//        
//        desForce34X = 0;
//        desForce34Y = 0;
//    
//        desForce78X = 0;
//        desForce78Y = 0;
        
        
        
        
    if (state1256 == 11){
        cmdVal1 = (00 - 3000*doo - motor1pos_current)*.0 - velMeasured1*0.0;
        cmdVal2 = (00 - 3000*doo - motor2pos_current)*.0 - velMeasured2*0.0;
    
        cmdVal5 = (00 - 3000*doo - motor5pos_current)*.0 - velMeasured5*0.0;
        cmdVal6 = (00 - 3000*doo - motor6pos_current)*.0 - velMeasured6*0.0;

        cmdVal3 = (00 - 3000*doo - motor3pos_current)*.0 - velMeasured3*0.0;
        cmdVal4 = (00 - 3000*doo - motor4pos_current)*.0 - velMeasured4*0.0;
    
        cmdVal7 = (00 - 3000*doo - motor7pos_current)*.0 - velMeasured7*0.0;
        cmdVal8 = (00 - 3000*doo - motor8pos_current)*.0 - velMeasured8*0.0;
        
        desForce34X = 0;
        desForce34Y = 0;
    
        desForce78X = 0;
        desForce78Y = 0;
   
    
        desForce12X = 0;
        desForce12Y = 0;
    
        desForce56X = 0;
        desForce56Y = -20;
        
    }        

    

    
    stateA = 0;
//    stateB = 00
   // doo = 0;
    
    
    if (state1256 == 4){
        cmdVal1 = (00 - 1000*doo - motor1pos_current)*.2 - velMeasured1*0.01;
        cmdVal2 = (00 - 1000*doo - motor2pos_current)*.2 - velMeasured2*0.01;
    
        cmdVal5 = (00 - 6000*doo - motor5pos_current)*.2 - velMeasured5*0.01;
        cmdVal6 = (00 - 6000*doo - motor6pos_current)*.2 - velMeasured6*0.01;

        cmdVal3 = (00 - 4000*doo - motor3pos_current)*.2 - velMeasured3*0.01;
        cmdVal4 = (00 - 4000*doo - motor4pos_current)*.2 - velMeasured4*0.01;
    
        cmdVal7 = (00 - 3000*doo - motor7pos_current)*.2 - velMeasured7*0.01;
        cmdVal8 = (00 - 3000*doo - motor8pos_current)*.2 - velMeasured8*0.01;
        
        desForce34X = 0;
        desForce34Y = 0;
    
        desForce78X = 0;
        desForce78Y = 0;
   
    
        desForce12X = 0;
        desForce12Y = 0;
    
        desForce56X = 0;
        desForce56Y = 0;
        LED5_Write(0);
        
    }
        
        
    if (state1256 == 1){
        stateCount1256 = stateCount1256 + 1;
        
        cmdVal1 = (00 - 1000*doo - motor1pos_current)*.3 - velMeasured1*0.01;
        cmdVal2 = (00 - 1000*doo - motor2pos_current)*.3 - velMeasured2*0.01;
    
        cmdVal5 = (00 - 1000*doo - motor5pos_current)*.3 - velMeasured5*0.01;
        cmdVal6 = (00 - 1000*doo - motor6pos_current)*.3 - velMeasured6*0.01;

    
    
    
        desForce12X = 0;
        desForce12Y = 0;
        LED3_Write(1);
        desForce56X = 0;
        desForce56Y = 0;
        LED2_Write(1);
        if (stateCount1256 > 50){
            stateCount1256 = 0;
            state1256 = 2;
            
            
            
        }
    }
    else if (state1256 == 2){
        stateCount1256 = stateCount1256 + 1;
        
        cmdVal1 = (00 - 0000*doo - motor1pos_current)*.2 - velMeasured1*0.01;
        cmdVal2 = (00 - 3000*doo - motor2pos_current)*.2 - velMeasured2*0.01;
   
        cmdVal5 = (00 - 0000*doo - motor5pos_current)*.2 - velMeasured5*0.01;
        cmdVal6 = (00 - 3000*doo - motor6pos_current)*.2 - velMeasured6*0.01;
    
        desForce12X = 0;
        desForce12Y = 0;
    
        desForce56X = 0;
        desForce56Y = 0;

        if (foot12_Read() == 0){
            stateCount1256 = 0;
            state1256 = 3;
            LED2_Write(0);
        }
        if (foot56_Read() == 0){
            stateCount1256 = 0;
            state1256 = 3;
            LED2_Write(0);
        }
    }
    else if (state1256 == 3){
        stateCount1256 = stateCount1256 + 1;
        
        int tt = 320;
        int Fy12 = -15;
        
        if (stateCount1256 < tt/2){
            Fy12 = -stateCount1256*1;
        }
        else{
            Fy12 = (-tt - stateCount1256)*1;
        }
        
        
        cmdVal1 = (00 - 0000*doo - motor1pos_current)*.3 - velMeasured1*0.003;
        cmdVal2 = (00 - 3000*doo - motor2pos_current)*.3 - velMeasured2*0.003;

        cmdVal5 = (00 - 0000*doo - motor5pos_current)*.3 - velMeasured5*0.003;
        cmdVal6 = (00 - 3000*doo - motor6pos_current)*.3 - velMeasured6*0.003;
        
        desForce12X = 1.25*Fy12/20;
        desForce12Y = 1.35*Fy12/3;
    
        desForce56X = Fy12/20;
        desForce56Y = Fy12/3;

        if (stateCount1256 > tt){
            stateCount1256 = 0;
            state1256 = 1;
            
            jumps1256 = jumps1256 + 1;
            if (jumps1256 > 7){
                state1256 = 4;
                state3478 = 4; 
            }
        }
        
        
    }
    
    
    
    if (state3478 == 1){
        stateCount3478 = stateCount3478 + 1;
        
        cmdVal3 = (00 - 1000*doo - motor3pos_current)*.3 - velMeasured3*0.01;
        cmdVal4 = (00 - 1000*doo - motor4pos_current)*.3 - velMeasured4*0.01;
    
        cmdVal7 = (00 - 1000*doo - motor7pos_current)*.3 - velMeasured7*0.01;
        cmdVal8 = (00 - 1000*doo - motor8pos_current)*.3 - velMeasured8*0.01;
        
        desForce34X = 0;
        desForce34Y = 0;
        LED3_Write(0);
        desForce78X = 0;
        desForce78Y = 0;
    
        if (stateCount3478 > 50){
            stateCount3478 = 0;
            state3478 = 2;
            LED4_Write(1);
            
        }
    }
    else if (state3478 == 2){
        stateCount3478 = stateCount3478 + 1;
        
        cmdVal3 = (00 - 3000*doo - motor3pos_current)*.2 - velMeasured3*0.01;
        cmdVal4 = (00 - 2000*doo - motor4pos_current)*.2 - velMeasured4*0.01;
   
        cmdVal7 = (00 - 3000*doo - motor7pos_current)*.2 - velMeasured7*0.01;
        cmdVal8 = (00 - 2000*doo - motor8pos_current)*.2 - velMeasured8*0.01;
    
        desForce34X = 0;
        desForce34Y = 0;
    
        desForce78X = 0;
        desForce78Y = 0;

        if (foot34_Read() == 0){
            stateCount3478 = 0;
            state3478 = 3;
            LED4_Write(0);
        }
        if (foot78_Read() == 0){
            stateCount3478 = 0;
            state3478 = 3;
            LED4_Write(0);
        }
    }
    else if (state3478 == 3){
        stateCount3478 = stateCount3478 + 1;
        
        int tt = 420;
        int Fy34 = -15;
        
        if (stateCount3478 < tt/2){
            Fy34 = -stateCount3478;
        }
        else{
            Fy34 = (-tt - stateCount3478);
        }
        
        
        cmdVal3 = (00 - 3000*doo - motor3pos_current)*.4 - velMeasured3*0.005;
        cmdVal4 = (00 - 2000*doo - motor4pos_current)*.4 - velMeasured4*0.005;

        cmdVal7 = (00 - 3000*doo - motor7pos_current)*.3 - velMeasured7*0.003;
        cmdVal8 = (00 - 2000*doo - motor8pos_current)*.3 - velMeasured8*0.003;
        
        desForce34X = Fy34/15;
        desForce34Y = Fy34/3;
    
        desForce78X = 0*Fy34/3;
        desForce78Y = 0*Fy34/3;
    

        if (stateCount3478 > tt){
            stateCount3478 = 0;
            state3478 = 1;
            
            jumps3478 = jumps3478 + 1;
            if (jumps3478 > 7){
                state1256 = 4;
                state3478 = 4; 
            }
        }
        
    }
    
    

    
//    cmdVal3 = (00 + 6000*doo - motor3pos_current)*.1 - velMeasured3*0.004;
//    //cmdVal3 = 0;
//    cmdVal4 = (00 + 6000*doo - motor4pos_current)*.1 - velMeasured4*0.004;
//    cmdVal4 = 0;
//    desForceAX = 0;
//    desForceAY = 0;
//    desForceBX = 0;
//    desForceBY = 0;

//    if (stateA == 1){
//        cmdVal1 = (-3000 - motor1pos_current)*.3 - velMeasured1*0.0025;
//        cmdVal2 = (-3000 - motor2pos_current)*.3 - velMeasured2*0.0025;
//        
//        if (stateCountA > 100 && foot12_Read() == 0){
//            stateA = 2;
//            stateCountA = 0;
//        }
//        desForceAX = 0;
//        desForceAY = 0;
//        
//        
//    }
//    
//    else if (stateA == 2){
//        
//        int aa = 0;
//        if (stateCountA < 200){
//            aa = stateCountA;
//        }
//        else{
//            aa = 400 - stateCountA;
//        }
//        
////        cmdVal1 = (-2000-aa*60 - motor1pos_current)*.4 - velMeasured1*0.005;
////        cmdVal2 = (-2000-aa*60 - motor2pos_current)*.4 - velMeasured2*0.005;
//        cmdVal1 = (-3000 - motor1pos_current)*.06 - velMeasured1*0.0025;
//        cmdVal2 = (-3000 - motor2pos_current)*.06 - velMeasured2*0.0025;
//        
//        desForceAX = 0;
//        desForceAY = -aa;
//        
//        
//        if (stateCountA > 400){
//            stateA = 1;
//            stateCountA = 0;
//        }
//    }
//
//    
//    
//    
//    
//    if (stateB == 1){
//        cmdVal3 = (-3000 - motor3pos_current)*.2 - velMeasured3*0.0025;
//        cmdVal4 = (-3000 - motor4pos_current)*.2 - velMeasured4*0.0025;
//        desForceBX = 0;
//        desForceBY = 0;
//        
//        if (stateCountB > 100 && foot34_Read() == 0){
//            stateB = 2;
//            stateCountB = 0;
//        }
//
//        
//        
//    }
//    
//    else if (stateB == 2){
//        
//        int bb = 0;
//        if (stateCountB < 200){
//            bb = stateCountB;
//        }
//        else{
//            bb = 400 - stateCountB;
//        }
//        
//        
////        cmdVal3 = (-2000-bb*60 - motor3pos_current)*.2 - velMeasured3*0.0025;
////        cmdVal4 = (-2000-bb*60 - motor4pos_current)*.2 - velMeasured4*0.0025;
//        cmdVal3 = (-3000 - bb*0 - motor3pos_current)*.06 - velMeasured3*0.003;
//        cmdVal4 = (-3000 - bb*0 - motor4pos_current)*.06 - velMeasured4*0.003;
//        
//        desForceBX = 0;
//        desForceBY = -bb;
//        
//        if (stateCountB > 400){
//            stateB = 1;
//            stateCountB = 0;
//        }
//    }
    


    
        angleIndex1 = round_integer((angle1/2.0))+10;
        if (angleIndex1<0){
            angleIndex1 = 0;}
        if (angleIndex1>59){
            angleIndex1 = 59;}

        angleIndex2 = round_integer((angle2/2.0))+10;
        if (angleIndex2<0){
            angleIndex2 = 0;}
        if (angleIndex2>59){
        angleIndex2 = 59;}

        torque1 = (J1_1[angleIndex2][angleIndex1])*desForce12X + (J1_2[angleIndex2][angleIndex1])*desForce12Y; //measured in Nm*100000
        torque2 = (J2_1[angleIndex2][angleIndex1])*desForce12X + (J2_2[angleIndex2][angleIndex1])*desForce12Y; //measured in Nm*100000
        
        torque1 = torque1/1000;
        torque2 = torque2/1000;
        
        cmdVal1 += (torque1*4800)/(100*6*0.0416*23);
        cmdVal2 += (torque2*4800)/(100*6*0.0416*23);    
        
        
        
        
        
        

        angleIndex3 = round_integer((angle3/2.0))+10;
        if (angleIndex3<0){
            angleIndex3 = 0;}
        if (angleIndex3>59){
            angleIndex3 = 59;}

        angleIndex4 = round_integer((angle4/2.0))+10;
        if (angleIndex4<0){
            angleIndex4 = 0;}
        if (angleIndex4>59){
        angleIndex4 = 59;}

        torque3 = (J1_1[angleIndex4][angleIndex3])*desForce34X + (J1_2[angleIndex4][angleIndex3])*desForce34Y; //measured in Nm*100000
        torque4 = (J2_1[angleIndex4][angleIndex3])*desForce34X + (J2_2[angleIndex4][angleIndex3])*desForce34Y; //measured in Nm*100000
        
        torque3 = torque3/1000;
        torque4 = torque4/1000;
       
        cmdVal3 += (torque3*4800)/(100*6*0.0416*23);
        cmdVal4 += (torque4*4800)/(100*6*0.0416*23);    

        
        
        
        
        angleIndex5 = round_integer((angle5/2.0))+10;
        if (angleIndex5<0){
            angleIndex5 = 0;}
        if (angleIndex5>59){
            angleIndex5 = 59;}

        angleIndex6 = round_integer((angle6/2.0))+10;
        if (angleIndex6<0){
            angleIndex6 = 0;}
        if (angleIndex6>59){
        angleIndex6 = 59;}

        torque5 = (J1_1[angleIndex6][angleIndex5])*desForce56X + (J1_2[angleIndex6][angleIndex5])*desForce56Y; //measured in Nm*100000
        torque6 = (J2_1[angleIndex6][angleIndex5])*desForce56X + (J2_2[angleIndex6][angleIndex5])*desForce56Y; //measured in Nm*100000
        
        torque5 = torque5/1000;
        torque6 = torque6/1000;
       
        cmdVal5 += (torque5*4800)/(100*6*0.0416*23);
        cmdVal6 += (torque6*4800)/(100*6*0.0416*23);         
        

        
        
        angleIndex7 = round_integer((angle7/2.0))+10;
        if (angleIndex7<0){
            angleIndex7 = 0;}
        if (angleIndex7>59){
            angleIndex7 = 59;}

        angleIndex8 = round_integer((angle8/2.0))+10;
        if (angleIndex8<0){
            angleIndex8 = 0;}
        if (angleIndex8>59){
        angleIndex8 = 59;}

        torque7 = (J1_1[angleIndex8][angleIndex7])*desForce78X + (J1_2[angleIndex8][angleIndex7])*desForce78Y; //measured in Nm*100000
        torque8 = (J2_1[angleIndex8][angleIndex7])*desForce78X + (J2_2[angleIndex8][angleIndex7])*desForce78Y; //measured in Nm*100000
        
        torque7 = torque7/1000;
        torque8 = torque8/1000;
       
        cmdVal7 += (torque7*4800)/(100*6*0.0416*23);
        cmdVal8 += (torque8*4800)/(100*6*0.0416*23);    
        
        
        
        
        
        if (cmdVal3 > 24000)
            cmdVal3 = 24000;
        if (cmdVal3 < -30000)
            cmdVal3 = -30000;

        if (cmdVal4 > 24000)
            cmdVal4 = 24000;
        if (cmdVal4 < -30000)
            cmdVal4 = -30000;
        

        
        //1200, 10800
        
        
        cmdVal1 = cmdVal1 + 6000;
        if (cmdVal1<minn) 
        {cmdVal1 = minn;}
        if (cmdVal1>maxx)
        {cmdVal1 = maxx;}
        
        cmdVal2 = -cmdVal2 + 6000;
        if (cmdVal2<minn) 
        {cmdVal2 = minn;}
        if (cmdVal2>maxx)
        {cmdVal2 = maxx;}
        

        cmdVal3 = -cmdVal3 + 6000;
        if (cmdVal3<minn) 
        {cmdVal3 = minn;}
        if (cmdVal3>maxx)
        {cmdVal3 = maxx;}
        
        cmdVal4 = cmdVal4 + 6000;
        if (cmdVal4<minn) 
        {cmdVal4 = minn;}
        if (cmdVal4>maxx)
        {cmdVal4 = maxx;}

        
        cmdVal5 = cmdVal5 + 6000;
        if (cmdVal5<minn) 
        {cmdVal5 = minn;}
        if (cmdVal5>maxx)
        {cmdVal5 = maxx;}
        
        cmdVal6 = -cmdVal6 + 6000;
        if (cmdVal6<minn) 
        {cmdVal6 = minn;}
        if (cmdVal6>maxx)
        {cmdVal6 = maxx;}
        
        cmdVal7 = cmdVal7 + 6000;
        if (cmdVal7<minn) 
        {cmdVal7 = minn;}
        if (cmdVal7>maxx)
        {cmdVal7 = maxx;}
        
        cmdVal8 = -cmdVal8 + 6000;
        if (cmdVal8<minn) 
        {cmdVal8 = minn;}
        if (cmdVal8>maxx)
        {cmdVal8 = maxx;}

        
        PWM_1_WriteCompare1(cmdVal1);
        PWM_1_WriteCompare2(cmdVal2);
        PWM_2_WriteCompare1(cmdVal3);
        PWM_2_WriteCompare2(cmdVal4);
        PWM_3_WriteCompare1(cmdVal5);
        PWM_3_WriteCompare2(cmdVal6);
        PWM_4_WriteCompare(cmdVal7);
        PWM_5_WriteCompare(cmdVal8);
 
        if(ePin_Read() == 0)
        {Estop = 1;}
    }
    
    UART_1_PutString("ESTOPPED");
    LED1_Write(0);
    LED2_Write(0);
    LED3_Write(0);
    LED5_Write(1);
    Enable_1_Write(0);
    Enable_2_Write(0);
    Enable_3_Write(0);
    Enable_4_Write(0);
    Enable_5_Write(0);
    Enable_6_Write(0);
    Enable_7_Write(0);
    Enable_8_Write(0);

    }


/* [] END OF FILE */
